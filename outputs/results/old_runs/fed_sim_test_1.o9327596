
Experimental details:
    Model     : resnet
    Optimizer : adam
    Learning  : 0.001
    Global Rounds   : 2

    Fraction of users  : 1.0
    Local Batch size   : 256
    Local Epochs       : 1.0

device:  cuda
sampling for dataset: mnist
Files already downloaded and verified
dataset sample num: (50000, 32, 32, 3)
Files already downloaded and verified
Files already downloaded and verified
get dataset time: 3.632
sample dataset time: 0.017
user data samples: [25000, 25000]
Namespace(epochs=2, num_users=2, frac=1.0, local_ep=1.0, local_bs=256, lr=0.001, momentum=0.9, num_workers=16, model='resnet', batch_size=256, weight_decay=0.0005, dataset='mnist', backbone='resnet18', num_classes=10, gpu='0', optimizer='adam', save_name_suffix='', iid=0, verbose=0, seed=1, feature_dim=128, temperature=0.5, k=200, ssl_method='simclr', x_noniid=False, dirichlet=False, test_intermediate=False, dir_beta=0.5, imagenet_based_cluster=False, y_partition=False, log_file_name='skew_ssl_comm', num_clusters=2, imagenet100=False, y_partition_skew=True, y_partition_ratio=0.0, x_shift_dirichlet=False, reg_scale=1, load_pretrained_path='', full_size=False, local_rank=0, distributed_training=False, log_directory='comm_scripts', emd=0, dist_url='env://', average_without_bn=False, model_continue_training=0, finetuning_epoch=2, script_name='', x_shift_skew=False, load_dataset_to_memory=False)
output model: save/24_04_2024_20:07:02_2425217
number of users per round: 2
total number of rounds: 2

 | Global Training Round : 1 | Model : 24_04_2024_20:07:02_2425217

Update SSL || User : 0 | Global Round : 0 | Local Epoch : 0.0 | [0/20000 (0%)]	Loss: 6.145090                         LR: 0.0001  Feat: 0.749 Epoch Time: 11.885 Model Time: 8.930 Data Time: 0.996 Model: 24_04_2024_20:07:02_2425217
Update SSL || User : 0 | Global Round : 0 | Local Epoch : 0.0 | [2560/20000 (13%)]	Loss: 5.830308                         LR: 0.0001  Feat: 0.781 Epoch Time: 15.326 Model Time: 0.050 Data Time: 0.094 Model: 24_04_2024_20:07:02_2425217
Update SSL || User : 0 | Global Round : 0 | Local Epoch : 0.0 | [5120/20000 (26%)]	Loss: 5.722612                         LR: 0.0001  Feat: 0.775 Epoch Time: 18.763 Model Time: 0.051 Data Time: 0.095 Model: 24_04_2024_20:07:02_2425217
Update SSL || User : 0 | Global Round : 0 | Local Epoch : 0.0 | [7680/20000 (38%)]	Loss: 5.515711                         LR: 0.0001  Feat: 0.795 Epoch Time: 22.233 Model Time: 0.050 Data Time: 0.095 Model: 24_04_2024_20:07:02_2425217
Update SSL || User : 0 | Global Round : 0 | Local Epoch : 0.0 | [10240/20000 (51%)]	Loss: 5.594395                         LR: 0.0001  Feat: 0.795 Epoch Time: 25.661 Model Time: 0.050 Data Time: 0.094 Model: 24_04_2024_20:07:02_2425217
Update SSL || User : 0 | Global Round : 0 | Local Epoch : 0.0 | [12800/20000 (64%)]	Loss: 5.545152                         LR: 0.0001  Feat: 0.816 Epoch Time: 29.103 Model Time: 0.049 Data Time: 0.096 Model: 24_04_2024_20:07:02_2425217
Update SSL || User : 0 | Global Round : 0 | Local Epoch : 0.0 | [15360/20000 (77%)]	Loss: 5.526160                         LR: 0.0001  Feat: 0.829 Epoch Time: 32.568 Model Time: 0.051 Data Time: 0.096 Model: 24_04_2024_20:07:02_2425217
Update SSL || User : 0 | Global Round : 0 | Local Epoch : 0.0 | [17920/20000 (90%)]	Loss: 5.479411                         LR: 0.0001  Feat: 0.834 Epoch Time: 36.017 Model Time: 0.050 Data Time: 0.095 Model: 24_04_2024_20:07:02_2425217
Update SSL || User : 1 | Global Round : 0 | Local Epoch : 0.0 | [0/20000 (0%)]	Loss: 6.174033                         LR: 0.0001  Feat: 0.755 Epoch Time: 2.887 Model Time: 0.062 Data Time: 0.741 Model: 24_04_2024_20:07:02_2425217
Update SSL || User : 1 | Global Round : 0 | Local Epoch : 0.0 | [2560/20000 (13%)]	Loss: 5.843655                         LR: 0.0001  Feat: 0.759 Epoch Time: 6.343 Model Time: 0.051 Data Time: 0.095 Model: 24_04_2024_20:07:02_2425217
Update SSL || User : 1 | Global Round : 0 | Local Epoch : 0.0 | [5120/20000 (26%)]	Loss: 5.686488                         LR: 0.0001  Feat: 0.779 Epoch Time: 9.788 Model Time: 0.052 Data Time: 0.095 Model: 24_04_2024_20:07:02_2425217
Update SSL || User : 1 | Global Round : 0 | Local Epoch : 0.0 | [7680/20000 (38%)]	Loss: 5.618569                         LR: 0.0001  Feat: 0.809 Epoch Time: 13.234 Model Time: 0.052 Data Time: 0.095 Model: 24_04_2024_20:07:02_2425217
Update SSL || User : 1 | Global Round : 0 | Local Epoch : 0.0 | [10240/20000 (51%)]	Loss: 5.589510                         LR: 0.0001  Feat: 0.807 Epoch Time: 16.689 Model Time: 0.051 Data Time: 0.095 Model: 24_04_2024_20:07:02_2425217
Update SSL || User : 1 | Global Round : 0 | Local Epoch : 0.0 | [12800/20000 (64%)]	Loss: 5.531264                         LR: 0.0001  Feat: 0.827 Epoch Time: 20.126 Model Time: 0.053 Data Time: 0.095 Model: 24_04_2024_20:07:02_2425217
Update SSL || User : 1 | Global Round : 0 | Local Epoch : 0.0 | [15360/20000 (77%)]	Loss: 5.540399                         LR: 0.0001  Feat: 0.825 Epoch Time: 23.552 Model Time: 0.051 Data Time: 0.096 Model: 24_04_2024_20:07:02_2425217
Update SSL || User : 1 | Global Round : 0 | Local Epoch : 0.0 | [17920/20000 (90%)]	Loss: 5.537990                         LR: 0.0001  Feat: 0.841 Epoch Time: 26.981 Model Time: 0.051 Data Time: 0.095 Model: 24_04_2024_20:07:02_2425217

 | Global Training Round : 2 | Model : 24_04_2024_20:07:02_2425217

Update SSL || User : 1 | Global Round : 1 | Local Epoch : 1.0 | [0/20000 (0%)]	Loss: 5.431673                         LR: 0.0000  Feat: 0.842 Epoch Time: 2.964 Model Time: 0.060 Data Time: 0.840 Model: 24_04_2024_20:07:02_2425217
Update SSL || User : 1 | Global Round : 1 | Local Epoch : 1.0 | [2560/20000 (13%)]	Loss: 5.446836                         LR: 0.0000  Feat: 0.840 Epoch Time: 6.414 Model Time: 0.051 Data Time: 0.096 Model: 24_04_2024_20:07:02_2425217
Update SSL || User : 1 | Global Round : 1 | Local Epoch : 1.0 | [5120/20000 (26%)]	Loss: 5.490498                         LR: 0.0000  Feat: 0.833 Epoch Time: 9.852 Model Time: 0.050 Data Time: 0.094 Model: 24_04_2024_20:07:02_2425217
Update SSL || User : 1 | Global Round : 1 | Local Epoch : 1.0 | [7680/20000 (38%)]	Loss: 5.542192                         LR: 0.0000  Feat: 0.831 Epoch Time: 13.280 Model Time: 0.051 Data Time: 0.096 Model: 24_04_2024_20:07:02_2425217
Update SSL || User : 1 | Global Round : 1 | Local Epoch : 1.0 | [10240/20000 (51%)]	Loss: 5.487514                         LR: 0.0000  Feat: 0.836 Epoch Time: 16.706 Model Time: 0.051 Data Time: 0.096 Model: 24_04_2024_20:07:02_2425217
Update SSL || User : 1 | Global Round : 1 | Local Epoch : 1.0 | [12800/20000 (64%)]	Loss: 5.421478                         LR: 0.0000  Feat: 0.836 Epoch Time: 20.127 Model Time: 0.050 Data Time: 0.096 Model: 24_04_2024_20:07:02_2425217
Update SSL || User : 1 | Global Round : 1 | Local Epoch : 1.0 | [15360/20000 (77%)]	Loss: 5.532618                         LR: 0.0000  Feat: 0.834 Epoch Time: 23.556 Model Time: 0.051 Data Time: 0.096 Model: 24_04_2024_20:07:02_2425217
Update SSL || User : 1 | Global Round : 1 | Local Epoch : 1.0 | [17920/20000 (90%)]	Loss: 5.466483                         LR: 0.0000  Feat: 0.838 Epoch Time: 26.979 Model Time: 0.050 Data Time: 0.096 Model: 24_04_2024_20:07:02_2425217
Update SSL || User : 0 | Global Round : 1 | Local Epoch : 1.0 | [0/20000 (0%)]	Loss: 5.455193                         LR: 0.0000  Feat: 0.836 Epoch Time: 2.950 Model Time: 0.059 Data Time: 0.841 Model: 24_04_2024_20:07:02_2425217
Update SSL || User : 0 | Global Round : 1 | Local Epoch : 1.0 | [2560/20000 (13%)]	Loss: 5.490597                         LR: 0.0000  Feat: 0.838 Epoch Time: 6.395 Model Time: 0.050 Data Time: 0.096 Model: 24_04_2024_20:07:02_2425217
Update SSL || User : 0 | Global Round : 1 | Local Epoch : 1.0 | [5120/20000 (26%)]	Loss: 5.480858                         LR: 0.0000  Feat: 0.834 Epoch Time: 9.883 Model Time: 0.050 Data Time: 0.096 Model: 24_04_2024_20:07:02_2425217
Update SSL || User : 0 | Global Round : 1 | Local Epoch : 1.0 | [7680/20000 (38%)]	Loss: 5.495998                         LR: 0.0000  Feat: 0.841 Epoch Time: 13.312 Model Time: 0.050 Data Time: 0.096 Model: 24_04_2024_20:07:02_2425217
Update SSL || User : 0 | Global Round : 1 | Local Epoch : 1.0 | [10240/20000 (51%)]	Loss: 5.473082                         LR: 0.0000  Feat: 0.829 Epoch Time: 16.745 Model Time: 0.050 Data Time: 0.096 Model: 24_04_2024_20:07:02_2425217
Update SSL || User : 0 | Global Round : 1 | Local Epoch : 1.0 | [12800/20000 (64%)]	Loss: 5.452436                         LR: 0.0000  Feat: 0.838 Epoch Time: 20.168 Model Time: 0.051 Data Time: 0.096 Model: 24_04_2024_20:07:02_2425217
Update SSL || User : 0 | Global Round : 1 | Local Epoch : 1.0 | [15360/20000 (77%)]	Loss: 5.443455                         LR: 0.0000  Feat: 0.834 Epoch Time: 23.586 Model Time: 0.051 Data Time: 0.096 Model: 24_04_2024_20:07:02_2425217
Update SSL || User : 0 | Global Round : 1 | Local Epoch : 1.0 | [17920/20000 (90%)]	Loss: 5.492718                         LR: 0.0000  Feat: 0.836 Epoch Time: 27.014 Model Time: 0.050 Data Time: 0.096 Model: 24_04_2024_20:07:02_2425217
 
Avg Training Stats after 2 global rounds:
Training Local Client Loss : nan
evaluating representations:  save/24_04_2024_20:07:02_2425217
sampling for dataset: mnist
Files already downloaded and verified
dataset sample num: (50000, 32, 32, 3)
Files already downloaded and verified
Files already downloaded and verified
get dataset time: 2.080
sample dataset time: 0.017
user data samples: [25000, 25000]
begin training classifier...
Downstream Train Epoch: 1 [0/50000 (0%)]	Loss: 2.516905
Downstream Train Epoch: 1 [12800/50000 (26%)]	Loss: 1.960880
Downstream Train Epoch: 1 [25600/50000 (51%)]	Loss: 1.986253
Downstream Train Epoch: 1 [38400/50000 (77%)]	Loss: 1.997705

 Downstream Train loss: 2.011059502557832 Acc: 0.3235
Downstream Train Epoch: 2 [0/50000 (0%)]	Loss: 1.988974
Downstream Train Epoch: 2 [12800/50000 (26%)]	Loss: 1.903212
Downstream Train Epoch: 2 [25600/50000 (51%)]	Loss: 1.950125
Downstream Train Epoch: 2 [38400/50000 (77%)]	Loss: 1.999498

 Downstream Train loss: 1.962237878113377 Acc: 0.358
 
 Results after 2 global rounds of training:
|---- Test Accuracy: 35.80%

 Total Run Time: 144.1020
Namespace(epochs=2, num_users=2, frac=1.0, local_ep=1.0, local_bs=256, lr=0.001, momentum=0.9, num_workers=16, model='resnet', batch_size=256, weight_decay=0.0005, dataset='mnist', backbone='resnet18', num_classes=10, gpu='0', optimizer='adam', save_name_suffix='', iid=0, verbose=0, seed=1, feature_dim=128, temperature=0.5, k=200, ssl_method='simclr', x_noniid=False, dirichlet=False, test_intermediate=False, dir_beta=0.5, imagenet_based_cluster=False, y_partition=False, log_file_name='skew_ssl_comm', num_clusters=2, imagenet100=False, y_partition_skew=True, y_partition_ratio=0.0, x_shift_dirichlet=False, reg_scale=1, load_pretrained_path='', full_size=False, local_rank=0, distributed_training=False, log_directory='comm_scripts', emd=0, dist_url='env://', average_without_bn=False, model_continue_training=0, finetuning_epoch=2, script_name='', x_shift_skew=False, load_dataset_to_memory=False, model_time='24_04_2024_20:07:02_2425217', start_time=datetime.datetime(2024, 4, 24, 20, 7, 2, 298666))
writing best results for resnet_256_2__dec_ssl_simclr___mnist_acc_0.358_num of user_2_frac_1.0_epoch_2_local_ep_1.0_local_bs_256_lr_0.001_backbone_resnet18_dirichlet False_0.5_imagenet_based_cluster_False_partition_skew_True_partition_skew_ratio_0.0_iid_0_reg scale_1_cont opt_0_24_04_2024_20:07:02_2425217_elapsed_time_140: 0.358 !
