
Experimental details:
    Model     : resnet
    Optimizer : adam
    Learning  : 0.001
    Global Rounds   : 30

    Fraction of users  : 1.0
    Local Batch size   : 256
    Local Epochs       : 5.0

Running model details  dirich_False_dec-True_ED-True_pe0.3_a5_e30_le5.0
device:  cuda
sampling for dataset: mnist
Files already downloaded and verified
train dataset sample num: (50000, 32, 32, 3)
Files already downloaded and verified
Files already downloaded and verified
get dataset time: 2.202
Use i.i.d. sampling
Use i.i.d. sampling
sample dataset time: 0.066
user data samples: [10000, 10000, 10000, 10000, 10000]
Namespace(split_dataset=None, average_with_A=False, phi_equal_w=False, exact_diffusion=True, decentralized=True, edge_prob=0.3, epochs=30, num_users=5, frac=1.0, local_ep=5.0, local_bs=256, lr=0.001, momentum=0.9, num_workers=16, model='resnet', batch_size=256, weight_decay=0.0005, dataset='mnist', backbone='resnet18', num_classes=10, gpu='1', optimizer='adam', save_name_suffix='', iid=1, verbose=0, seed=1, feature_dim=128, temperature=0.5, k=200, ssl_method='simclr', x_noniid=False, dirichlet=False, test_intermediate=False, dir_beta=0.5, imagenet_based_cluster=False, y_partition=False, log_file_name='comm_scripts/best_linear_statistics_skew_ssl_comm.csv', num_clusters=1, imagenet100=False, y_partition_skew=False, y_partition_ratio=1, x_shift_dirichlet=False, reg_scale=1, load_pretrained_path='', full_size=False, local_rank=0, distributed_training=False, log_directory='exact_new_edge/06-08_00:09_drich-false_dec-true_ED-true_ep0.3_e30_le5_a5', emd=0, dist_url='env://', average_without_bn=False, model_continue_training=0, finetuning_epoch=40, script_name='', x_shift_skew=False, load_dataset_to_memory=False)
Backbone model function:  <function resnet18 at 0x7f024f2f17e0>
Backbone model function:  <function resnet18 at 0x7f024f2f17e0>
Backbone model function:  <function resnet18 at 0x7f024f2f17e0>
Backbone model function:  <function resnet18 at 0x7f024f2f17e0>
Backbone model function:  <function resnet18 at 0x7f024f2f17e0>
Backbone model function:  <function resnet18 at 0x7f024f2f17e0>
output model: save/06-08_00:10_12043dirich_False_dec-True_ED-True_pe0.3_a5_e30_le5.0
number of users per round: 5
total number of rounds: 6
Training uses 0.01 andd validation 0.010000000000000009 of the dataset
idx train:  100
Training uses 0.01 andd validation 0.010000000000000009 of the dataset
idx train:  100
Training uses 0.01 andd validation 0.010000000000000009 of the dataset
idx train:  100
Training uses 0.01 andd validation 0.010000000000000009 of the dataset
idx train:  100
Training uses 0.01 andd validation 0.010000000000000009 of the dataset
idx train:  100
attempted matrix  [[0. 1. 0. 0. 1.]
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 1.]
 [0. 0. 0. 0. 1.]
 [1. 0. 1. 1. 0.]]
successful matrix  [[0. 1. 0. 0. 1.]
 [1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 1.]
 [0. 0. 0. 0. 1.]
 [1. 0. 1. 1. 0.]]
3.0
4.0
4.0
4.0
matrix A  [[0.41666667 0.33333333 0.         0.         0.25      ]
 [0.33333333 0.66666667 0.         0.         0.        ]
 [0.         0.         0.75       0.         0.25      ]
 [0.         0.         0.         0.75       0.25      ]
 [0.25       0.         0.25       0.25       0.25      ]]
Second Eigenvalue of A:  0.8619250128455577
Createda a Communication graph with edges = :  [(0, 1), (0, 4), (2, 4), (3, 4)]
Number of edges:  4
Graph nodes:  [0, 1, 2, 3, 4]

 | Global Training Round : 1 | Model : 06-08_00:10_12043

Updating local model for agent:  0
Update SSL || User : 0 | Global Round : 0 | Local Epoch : 0.0 | [0/100 (0%)]	Loss: 5.153934                         LR: 0.0010  Feat: 0.775 Epoch Time: 2.856 Model Time: 1.621 Data Time: 1.234 Model: 06-08_00:10_12043
Update SSL || User : 0 | Global Round : 0 | Local Epoch : 1.0 | [0/100 (0%)]	Loss: 5.097200                         LR: 0.0010  Feat: 0.776 Epoch Time: 3.712 Model Time: 0.034 Data Time: 0.762 Model: 06-08_00:10_12043
Update SSL || User : 0 | Global Round : 0 | Local Epoch : 2.0 | [0/100 (0%)]	Loss: 4.870822                         LR: 0.0010  Feat: 0.786 Epoch Time: 4.628 Model Time: 0.034 Data Time: 0.804 Model: 06-08_00:10_12043
Update SSL || User : 0 | Global Round : 0 | Local Epoch : 3.0 | [0/100 (0%)]	Loss: 4.853003                         LR: 0.0010  Feat: 0.783 Epoch Time: 5.541 Model Time: 0.036 Data Time: 0.803 Model: 06-08_00:10_12043
Update SSL || User : 0 | Global Round : 0 | Local Epoch : 4.0 | [0/100 (0%)]	Loss: 4.941356                         LR: 0.0010  Feat: 0.773 Epoch Time: 6.444 Model Time: 0.038 Data Time: 0.794 Model: 06-08_00:10_12043
New Find_phi_psi for agent:  0
Updating local model for agent:  1
Update SSL || User : 1 | Global Round : 0 | Local Epoch : 0.0 | [0/100 (0%)]	Loss: 5.205070                         LR: 0.0010  Feat: 0.776 Epoch Time: 0.867 Model Time: 0.040 Data Time: 0.812 Model: 06-08_00:10_12043
Update SSL || User : 1 | Global Round : 0 | Local Epoch : 1.0 | [0/100 (0%)]	Loss: 5.126121                         LR: 0.0010  Feat: 0.799 Epoch Time: 1.799 Model Time: 0.039 Data Time: 0.819 Model: 06-08_00:10_12043
Update SSL || User : 1 | Global Round : 0 | Local Epoch : 2.0 | [0/100 (0%)]	Loss: 5.119077                         LR: 0.0010  Feat: 0.824 Epoch Time: 2.683 Model Time: 0.040 Data Time: 0.773 Model: 06-08_00:10_12043
Update SSL || User : 1 | Global Round : 0 | Local Epoch : 3.0 | [0/100 (0%)]	Loss: 4.931034                         LR: 0.0010  Feat: 0.856 Epoch Time: 3.607 Model Time: 0.035 Data Time: 0.810 Model: 06-08_00:10_12043
Update SSL || User : 1 | Global Round : 0 | Local Epoch : 4.0 | [0/100 (0%)]	Loss: 4.824443                         LR: 0.0010  Feat: 0.865 Epoch Time: 4.515 Model Time: 0.037 Data Time: 0.801 Model: 06-08_00:10_12043
New Find_phi_psi for agent:  1
Updating local model for agent:  2
Update SSL || User : 2 | Global Round : 0 | Local Epoch : 0.0 | [0/100 (0%)]	Loss: 5.169698                         LR: 0.0010  Feat: 0.779 Epoch Time: 0.870 Model Time: 0.041 Data Time: 0.815 Model: 06-08_00:10_12043
Update SSL || User : 2 | Global Round : 0 | Local Epoch : 1.0 | [0/100 (0%)]	Loss: 5.093655                         LR: 0.0010  Feat: 0.792 Epoch Time: 1.837 Model Time: 0.041 Data Time: 0.835 Model: 06-08_00:10_12043
Update SSL || User : 2 | Global Round : 0 | Local Epoch : 2.0 | [0/100 (0%)]	Loss: 5.031906                         LR: 0.0010  Feat: 0.820 Epoch Time: 2.775 Model Time: 0.033 Data Time: 0.815 Model: 06-08_00:10_12043
Update SSL || User : 2 | Global Round : 0 | Local Epoch : 3.0 | [0/100 (0%)]	Loss: 4.821356                         LR: 0.0010  Feat: 0.840 Epoch Time: 3.693 Model Time: 0.030 Data Time: 0.804 Model: 06-08_00:10_12043
Update SSL || User : 2 | Global Round : 0 | Local Epoch : 4.0 | [0/100 (0%)]	Loss: 4.833871                         LR: 0.0010  Feat: 0.846 Epoch Time: 4.609 Model Time: 0.039 Data Time: 0.803 Model: 06-08_00:10_12043
New Find_phi_psi for agent:  2
Updating local model for agent:  3
Update SSL || User : 3 | Global Round : 0 | Local Epoch : 0.0 | [0/100 (0%)]	Loss: 5.256113                         LR: 0.0010  Feat: 0.772 Epoch Time: 0.883 Model Time: 0.037 Data Time: 0.830 Model: 06-08_00:10_12043
Update SSL || User : 3 | Global Round : 0 | Local Epoch : 1.0 | [0/100 (0%)]	Loss: 5.166593                         LR: 0.0010  Feat: 0.792 Epoch Time: 1.797 Model Time: 0.037 Data Time: 0.805 Model: 06-08_00:10_12043
Update SSL || User : 3 | Global Round : 0 | Local Epoch : 2.0 | [0/100 (0%)]	Loss: 5.077226                         LR: 0.0010  Feat: 0.790 Epoch Time: 2.708 Model Time: 0.030 Data Time: 0.798 Model: 06-08_00:10_12043
Update SSL || User : 3 | Global Round : 0 | Local Epoch : 3.0 | [0/100 (0%)]	Loss: 4.987803                         LR: 0.0010  Feat: 0.825 Epoch Time: 3.638 Model Time: 0.040 Data Time: 0.805 Model: 06-08_00:10_12043
Update SSL || User : 3 | Global Round : 0 | Local Epoch : 4.0 | [0/100 (0%)]	Loss: 4.919300                         LR: 0.0010  Feat: 0.832 Epoch Time: 4.555 Model Time: 0.034 Data Time: 0.798 Model: 06-08_00:10_12043
New Find_phi_psi for agent:  3
Updating local model for agent:  4
Update SSL || User : 4 | Global Round : 0 | Local Epoch : 0.0 | [0/100 (0%)]	Loss: 5.179138                         LR: 0.0010  Feat: 0.772 Epoch Time: 0.848 Model Time: 0.038 Data Time: 0.794 Model: 06-08_00:10_12043
Update SSL || User : 4 | Global Round : 0 | Local Epoch : 1.0 | [0/100 (0%)]	Loss: 5.066868                         LR: 0.0010  Feat: 0.771 Epoch Time: 1.786 Model Time: 0.039 Data Time: 0.831 Model: 06-08_00:10_12043
Update SSL || User : 4 | Global Round : 0 | Local Epoch : 2.0 | [0/100 (0%)]	Loss: 4.992040                         LR: 0.0010  Feat: 0.815 Epoch Time: 2.709 Model Time: 0.041 Data Time: 0.812 Model: 06-08_00:10_12043
Update SSL || User : 4 | Global Round : 0 | Local Epoch : 3.0 | [0/100 (0%)]	Loss: 4.972530                         LR: 0.0010  Feat: 0.789 Epoch Time: 3.617 Model Time: 0.040 Data Time: 0.802 Model: 06-08_00:10_12043
Update SSL || User : 4 | Global Round : 0 | Local Epoch : 4.0 | [0/100 (0%)]	Loss: 4.844021                         LR: 0.0010  Feat: 0.779 Epoch Time: 4.535 Model Time: 0.040 Data Time: 0.806 Model: 06-08_00:10_12043
New Find_phi_psi for agent:  4
Exact Diffusion
exact_diffusion_averaging
combine_to_state_dict between 5 agents

 | Global Training Round : 2 | Model : 06-08_00:10_12043

Updating local model for agent:  0
Update SSL || User : 0 | Global Round : 1 | Local Epoch : 5.0 | [0/100 (0%)]	Loss: 5.119387                         LR: 0.0003  Feat: 0.826 Epoch Time: 0.878 Model Time: 0.042 Data Time: 0.823 Model: 06-08_00:10_12043
Update SSL || User : 0 | Global Round : 1 | Local Epoch : 6.0 | [0/100 (0%)]	Loss: 4.943560                         LR: 0.0003  Feat: 0.835 Epoch Time: 1.804 Model Time: 0.030 Data Time: 0.808 Model: 06-08_00:10_12043
Update SSL || User : 0 | Global Round : 1 | Local Epoch : 7.0 | [0/100 (0%)]	Loss: 5.134192                         LR: 0.0003  Feat: 0.833 Epoch Time: 2.758 Model Time: 0.041 Data Time: 0.845 Model: 06-08_00:10_12043
Update SSL || User : 0 | Global Round : 1 | Local Epoch : 8.0 | [0/100 (0%)]	Loss: 4.685478                         LR: 0.0003  Feat: 0.852 Epoch Time: 3.701 Model Time: 0.038 Data Time: 0.824 Model: 06-08_00:10_12043
Update SSL || User : 0 | Global Round : 1 | Local Epoch : 9.0 | [0/100 (0%)]	Loss: 4.783292                         LR: 0.0003  Feat: 0.854 Epoch Time: 4.652 Model Time: 0.031 Data Time: 0.843 Model: 06-08_00:10_12043
New Find_phi_psi for agent:  0
Updating local model for agent:  1
Update SSL || User : 1 | Global Round : 1 | Local Epoch : 5.0 | [0/100 (0%)]	Loss: 4.853785                         LR: 0.0003  Feat: 0.854 Epoch Time: 0.889 Model Time: 0.042 Data Time: 0.834 Model: 06-08_00:10_12043
Update SSL || User : 1 | Global Round : 1 | Local Epoch : 6.0 | [0/100 (0%)]	Loss: 4.871015                         LR: 0.0003  Feat: 0.868 Epoch Time: 1.843 Model Time: 0.036 Data Time: 0.848 Model: 06-08_00:10_12043
Update SSL || User : 1 | Global Round : 1 | Local Epoch : 7.0 | [0/100 (0%)]	Loss: 4.801882                         LR: 0.0003  Feat: 0.874 Epoch Time: 2.779 Model Time: 0.037 Data Time: 0.830 Model: 06-08_00:10_12043
Update SSL || User : 1 | Global Round : 1 | Local Epoch : 8.0 | [0/100 (0%)]	Loss: 4.889369                         LR: 0.0003  Feat: 0.866 Epoch Time: 3.724 Model Time: 0.038 Data Time: 0.834 Model: 06-08_00:10_12043
Update SSL || User : 1 | Global Round : 1 | Local Epoch : 9.0 | [0/100 (0%)]	Loss: 4.829732                         LR: 0.0003  Feat: 0.873 Epoch Time: 4.675 Model Time: 0.035 Data Time: 0.819 Model: 06-08_00:10_12043
New Find_phi_psi for agent:  1
Updating local model for agent:  2
Update SSL || User : 2 | Global Round : 1 | Local Epoch : 5.0 | [0/100 (0%)]	Loss: 4.894488                         LR: 0.0003  Feat: 0.859 Epoch Time: 0.872 Model Time: 0.042 Data Time: 0.815 Model: 06-08_00:10_12043
Update SSL || User : 2 | Global Round : 1 | Local Epoch : 6.0 | [0/100 (0%)]	Loss: 4.744281                         LR: 0.0003  Feat: 0.847 Epoch Time: 1.818 Model Time: 0.038 Data Time: 0.828 Model: 06-08_00:10_12043
Update SSL || User : 2 | Global Round : 1 | Local Epoch : 7.0 | [0/100 (0%)]	Loss: 4.864616                         LR: 0.0003  Feat: 0.847 Epoch Time: 2.740 Model Time: 0.035 Data Time: 0.815 Model: 06-08_00:10_12043
Update SSL || User : 2 | Global Round : 1 | Local Epoch : 8.0 | [0/100 (0%)]	Loss: 4.802083                         LR: 0.0003  Feat: 0.847 Epoch Time: 3.675 Model Time: 0.031 Data Time: 0.817 Model: 06-08_00:10_12043
Update SSL || User : 2 | Global Round : 1 | Local Epoch : 9.0 | [0/100 (0%)]	Loss: 4.738594                         LR: 0.0003  Feat: 0.869 Epoch Time: 4.595 Model Time: 0.040 Data Time: 0.799 Model: 06-08_00:10_12043
New Find_phi_psi for agent:  2
Updating local model for agent:  3
Update SSL || User : 3 | Global Round : 1 | Local Epoch : 5.0 | [0/100 (0%)]	Loss: 4.966507                         LR: 0.0003  Feat: 0.854 Epoch Time: 0.877 Model Time: 0.043 Data Time: 0.819 Model: 06-08_00:10_12043
Update SSL || User : 3 | Global Round : 1 | Local Epoch : 6.0 | [0/100 (0%)]	Loss: 5.048781                         LR: 0.0003  Feat: 0.847 Epoch Time: 1.791 Model Time: 0.040 Data Time: 0.791 Model: 06-08_00:10_12043
Update SSL || User : 3 | Global Round : 1 | Local Epoch : 7.0 | [0/100 (0%)]	Loss: 4.839954                         LR: 0.0003  Feat: 0.854 Epoch Time: 2.740 Model Time: 0.038 Data Time: 0.824 Model: 06-08_00:10_12043
Update SSL || User : 3 | Global Round : 1 | Local Epoch : 8.0 | [0/100 (0%)]	Loss: 4.803313                         LR: 0.0003  Feat: 0.852 Epoch Time: 3.663 Model Time: 0.037 Data Time: 0.804 Model: 06-08_00:10_12043
Update SSL || User : 3 | Global Round : 1 | Local Epoch : 9.0 | [0/100 (0%)]	Loss: 4.821633                         LR: 0.0003  Feat: 0.874 Epoch Time: 4.579 Model Time: 0.034 Data Time: 0.803 Model: 06-08_00:10_12043
New Find_phi_psi for agent:  3
Updating local model for agent:  4
Update SSL || User : 4 | Global Round : 1 | Local Epoch : 5.0 | [0/100 (0%)]	Loss: 5.133562                         LR: 0.0003  Feat: 0.800 Epoch Time: 0.845 Model Time: 0.034 Data Time: 0.790 Model: 06-08_00:10_12043
Update SSL || User : 4 | Global Round : 1 | Local Epoch : 6.0 | [0/100 (0%)]	Loss: 5.067371                         LR: 0.0003  Feat: 0.833 Epoch Time: 1.759 Model Time: 0.031 Data Time: 0.805 Model: 06-08_00:10_12043
Update SSL || User : 4 | Global Round : 1 | Local Epoch : 7.0 | [0/100 (0%)]	Loss: 4.886371                         LR: 0.0003  Feat: 0.837 Epoch Time: 2.712 Model Time: 0.035 Data Time: 0.834 Model: 06-08_00:10_12043
Update SSL || User : 4 | Global Round : 1 | Local Epoch : 8.0 | [0/100 (0%)]	Loss: 4.920902                         LR: 0.0003  Feat: 0.839 Epoch Time: 3.630 Model Time: 0.034 Data Time: 0.792 Model: 06-08_00:10_12043
Update SSL || User : 4 | Global Round : 1 | Local Epoch : 9.0 | [0/100 (0%)]	Loss: 4.735815                         LR: 0.0003  Feat: 0.834 Epoch Time: 4.565 Model Time: 0.038 Data Time: 0.812 Model: 06-08_00:10_12043
New Find_phi_psi for agent:  4
Exact Diffusion
exact_diffusion_averaging
combine_to_state_dict between 5 agents

 | Global Training Round : 3 | Model : 06-08_00:10_12043

Updating local model for agent:  0
Update SSL || User : 0 | Global Round : 2 | Local Epoch : 10.0 | [0/100 (0%)]	Loss: 4.967764                         LR: 0.0003  Feat: 0.855 Epoch Time: 0.859 Model Time: 0.040 Data Time: 0.804 Model: 06-08_00:10_12043
Update SSL || User : 0 | Global Round : 2 | Local Epoch : 11.0 | [0/100 (0%)]	Loss: 4.960706                         LR: 0.0003  Feat: 0.857 Epoch Time: 1.814 Model Time: 0.039 Data Time: 0.837 Model: 06-08_00:10_12043
Update SSL || User : 0 | Global Round : 2 | Local Epoch : 12.0 | [0/100 (0%)]	Loss: 4.839147                         LR: 0.0003  Feat: 0.864 Epoch Time: 2.755 Model Time: 0.037 Data Time: 0.818 Model: 06-08_00:10_12043
Update SSL || User : 0 | Global Round : 2 | Local Epoch : 13.0 | [0/100 (0%)]	Loss: 4.827318                         LR: 0.0003  Feat: 0.876 Epoch Time: 3.693 Model Time: 0.038 Data Time: 0.826 Model: 06-08_00:10_12043
Update SSL || User : 0 | Global Round : 2 | Local Epoch : 14.0 | [0/100 (0%)]	Loss: 4.679254                         LR: 0.0003  Feat: 0.882 Epoch Time: 4.629 Model Time: 0.038 Data Time: 0.826 Model: 06-08_00:10_12043
New Find_phi_psi for agent:  0
Updating local model for agent:  1
Update SSL || User : 1 | Global Round : 2 | Local Epoch : 10.0 | [0/100 (0%)]	Loss: 4.871757                         LR: 0.0003  Feat: 0.862 Epoch Time: 0.890 Model Time: 0.041 Data Time: 0.835 Model: 06-08_00:10_12043
Update SSL || User : 1 | Global Round : 2 | Local Epoch : 11.0 | [0/100 (0%)]	Loss: 4.973083                         LR: 0.0003  Feat: 0.866 Epoch Time: 1.851 Model Time: 0.039 Data Time: 0.841 Model: 06-08_00:10_12043
Update SSL || User : 1 | Global Round : 2 | Local Epoch : 12.0 | [0/100 (0%)]	Loss: 4.935184                         LR: 0.0003  Feat: 0.854 Epoch Time: 2.784 Model Time: 0.039 Data Time: 0.817 Model: 06-08_00:10_12043
Update SSL || User : 1 | Global Round : 2 | Local Epoch : 13.0 | [0/100 (0%)]	Loss: 4.723019                         LR: 0.0003  Feat: 0.866 Epoch Time: 3.726 Model Time: 0.038 Data Time: 0.831 Model: 06-08_00:10_12043
Update SSL || User : 1 | Global Round : 2 | Local Epoch : 14.0 | [0/100 (0%)]	Loss: 4.712300                         LR: 0.0003  Feat: 0.878 Epoch Time: 4.681 Model Time: 0.041 Data Time: 0.825 Model: 06-08_00:10_12043
New Find_phi_psi for agent:  1
Updating local model for agent:  2
Update SSL || User : 2 | Global Round : 2 | Local Epoch : 10.0 | [0/100 (0%)]	Loss: 4.878677                         LR: 0.0003  Feat: 0.843 Epoch Time: 0.892 Model Time: 0.045 Data Time: 0.833 Model: 06-08_00:10_12043
Update SSL || User : 2 | Global Round : 2 | Local Epoch : 11.0 | [0/100 (0%)]	Loss: 5.059366                         LR: 0.0003  Feat: 0.839 Epoch Time: 1.807 Model Time: 0.037 Data Time: 0.789 Model: 06-08_00:10_12043
Update SSL || User : 2 | Global Round : 2 | Local Epoch : 12.0 | [0/100 (0%)]	Loss: 4.962382                         LR: 0.0003  Feat: 0.834 Epoch Time: 2.730 Model Time: 0.035 Data Time: 0.809 Model: 06-08_00:10_12043
Update SSL || User : 2 | Global Round : 2 | Local Epoch : 13.0 | [0/100 (0%)]	Loss: 4.640411                         LR: 0.0003  Feat: 0.835 Epoch Time: 3.675 Model Time: 0.037 Data Time: 0.818 Model: 06-08_00:10_12043
Update SSL || User : 2 | Global Round : 2 | Local Epoch : 14.0 | [0/100 (0%)]	Loss: 4.746949                         LR: 0.0003  Feat: 0.830 Epoch Time: 4.596 Model Time: 0.038 Data Time: 0.794 Model: 06-08_00:10_12043
New Find_phi_psi for agent:  2
Updating local model for agent:  3
Update SSL || User : 3 | Global Round : 2 | Local Epoch : 10.0 | [0/100 (0%)]	Loss: 5.020922                         LR: 0.0003  Feat: 0.864 Epoch Time: 0.847 Model Time: 0.040 Data Time: 0.792 Model: 06-08_00:10_12043
Update SSL || User : 3 | Global Round : 2 | Local Epoch : 11.0 | [0/100 (0%)]	Loss: 5.084005                         LR: 0.0003  Feat: 0.869 Epoch Time: 1.765 Model Time: 0.033 Data Time: 0.803 Model: 06-08_00:10_12043
Update SSL || User : 3 | Global Round : 2 | Local Epoch : 12.0 | [0/100 (0%)]	Loss: 4.916914                         LR: 0.0003  Feat: 0.869 Epoch Time: 2.656 Model Time: 0.033 Data Time: 0.787 Model: 06-08_00:10_12043
Update SSL || User : 3 | Global Round : 2 | Local Epoch : 13.0 | [0/100 (0%)]	Loss: 4.961300                         LR: 0.0003  Feat: 0.877 Epoch Time: 3.572 Model Time: 0.038 Data Time: 0.810 Model: 06-08_00:10_12043
Update SSL || User : 3 | Global Round : 2 | Local Epoch : 14.0 | [0/100 (0%)]	Loss: 4.816331                         LR: 0.0003  Feat: 0.890 Epoch Time: 4.486 Model Time: 0.040 Data Time: 0.803 Model: 06-08_00:10_12043
New Find_phi_psi for agent:  3
Updating local model for agent:  4
Update SSL || User : 4 | Global Round : 2 | Local Epoch : 10.0 | [0/100 (0%)]	Loss: 5.130707                         LR: 0.0003  Feat: 0.829 Epoch Time: 0.827 Model Time: 0.043 Data Time: 0.769 Model: 06-08_00:10_12043
Update SSL || User : 4 | Global Round : 2 | Local Epoch : 11.0 | [0/100 (0%)]	Loss: 4.946553                         LR: 0.0003  Feat: 0.831 Epoch Time: 1.770 Model Time: 0.039 Data Time: 0.826 Model: 06-08_00:10_12043
Update SSL || User : 4 | Global Round : 2 | Local Epoch : 12.0 | [0/100 (0%)]	Loss: 4.882205                         LR: 0.0003  Feat: 0.839 Epoch Time: 2.691 Model Time: 0.041 Data Time: 0.806 Model: 06-08_00:10_12043
Update SSL || User : 4 | Global Round : 2 | Local Epoch : 13.0 | [0/100 (0%)]	Loss: 4.818790                         LR: 0.0003  Feat: 0.824 Epoch Time: 3.609 Model Time: 0.039 Data Time: 0.792 Model: 06-08_00:10_12043
Update SSL || User : 4 | Global Round : 2 | Local Epoch : 14.0 | [0/100 (0%)]	Loss: 4.922222                         LR: 0.0003  Feat: 0.827 Epoch Time: 4.544 Model Time: 0.037 Data Time: 0.809 Model: 06-08_00:10_12043
New Find_phi_psi for agent:  4
Exact Diffusion
exact_diffusion_averaging
combine_to_state_dict between 5 agents

 | Global Training Round : 4 | Model : 06-08_00:10_12043

Updating local model for agent:  0
Update SSL || User : 0 | Global Round : 3 | Local Epoch : 15.0 | [0/100 (0%)]	Loss: 4.784749                         LR: 0.0001  Feat: 0.865 Epoch Time: 0.855 Model Time: 0.039 Data Time: 0.800 Model: 06-08_00:10_12043
Update SSL || User : 0 | Global Round : 3 | Local Epoch : 16.0 | [0/100 (0%)]	Loss: 4.780420                         LR: 0.0001  Feat: 0.866 Epoch Time: 1.799 Model Time: 0.038 Data Time: 0.833 Model: 06-08_00:10_12043
Update SSL || User : 0 | Global Round : 3 | Local Epoch : 17.0 | [0/100 (0%)]	Loss: 4.716582                         LR: 0.0001  Feat: 0.869 Epoch Time: 2.707 Model Time: 0.032 Data Time: 0.797 Model: 06-08_00:10_12043
Update SSL || User : 0 | Global Round : 3 | Local Epoch : 18.0 | [0/100 (0%)]	Loss: 4.844237                         LR: 0.0001  Feat: 0.869 Epoch Time: 3.659 Model Time: 0.040 Data Time: 0.833 Model: 06-08_00:10_12043
Update SSL || User : 0 | Global Round : 3 | Local Epoch : 19.0 | [0/100 (0%)]	Loss: 4.814544                         LR: 0.0001  Feat: 0.871 Epoch Time: 4.611 Model Time: 0.037 Data Time: 0.838 Model: 06-08_00:10_12043
New Find_phi_psi for agent:  0
Updating local model for agent:  1
Update SSL || User : 1 | Global Round : 3 | Local Epoch : 15.0 | [0/100 (0%)]	Loss: 4.728689                         LR: 0.0001  Feat: 0.870 Epoch Time: 0.899 Model Time: 0.042 Data Time: 0.843 Model: 06-08_00:10_12043
Update SSL || User : 1 | Global Round : 3 | Local Epoch : 16.0 | [0/100 (0%)]	Loss: 4.751755                         LR: 0.0001  Feat: 0.870 Epoch Time: 1.845 Model Time: 0.039 Data Time: 0.834 Model: 06-08_00:10_12043
Update SSL || User : 1 | Global Round : 3 | Local Epoch : 17.0 | [0/100 (0%)]	Loss: 4.844625                         LR: 0.0001  Feat: 0.871 Epoch Time: 2.820 Model Time: 0.041 Data Time: 0.854 Model: 06-08_00:10_12043
Update SSL || User : 1 | Global Round : 3 | Local Epoch : 18.0 | [0/100 (0%)]	Loss: 4.648679                         LR: 0.0001  Feat: 0.872 Epoch Time: 3.763 Model Time: 0.033 Data Time: 0.833 Model: 06-08_00:10_12043
Update SSL || User : 1 | Global Round : 3 | Local Epoch : 19.0 | [0/100 (0%)]	Loss: 4.747435                         LR: 0.0001  Feat: 0.871 Epoch Time: 4.743 Model Time: 0.039 Data Time: 0.860 Model: 06-08_00:10_12043
New Find_phi_psi for agent:  1
Updating local model for agent:  2
Update SSL || User : 2 | Global Round : 3 | Local Epoch : 15.0 | [0/100 (0%)]	Loss: 4.910467                         LR: 0.0001  Feat: 0.839 Epoch Time: 0.878 Model Time: 0.037 Data Time: 0.824 Model: 06-08_00:10_12043
Update SSL || User : 2 | Global Round : 3 | Local Epoch : 16.0 | [0/100 (0%)]	Loss: 4.771398                         LR: 0.0001  Feat: 0.846 Epoch Time: 1.814 Model Time: 0.037 Data Time: 0.819 Model: 06-08_00:10_12043
Update SSL || User : 2 | Global Round : 3 | Local Epoch : 17.0 | [0/100 (0%)]	Loss: 4.878813                         LR: 0.0001  Feat: 0.852 Epoch Time: 2.731 Model Time: 0.037 Data Time: 0.808 Model: 06-08_00:10_12043
Update SSL || User : 2 | Global Round : 3 | Local Epoch : 18.0 | [0/100 (0%)]	Loss: 4.690250                         LR: 0.0001  Feat: 0.845 Epoch Time: 3.664 Model Time: 0.037 Data Time: 0.821 Model: 06-08_00:10_12043
Update SSL || User : 2 | Global Round : 3 | Local Epoch : 19.0 | [0/100 (0%)]	Loss: 4.786073                         LR: 0.0001  Feat: 0.850 Epoch Time: 4.614 Model Time: 0.037 Data Time: 0.823 Model: 06-08_00:10_12043
New Find_phi_psi for agent:  2
Updating local model for agent:  3
Update SSL || User : 3 | Global Round : 3 | Local Epoch : 15.0 | [0/100 (0%)]	Loss: 4.906277                         LR: 0.0001  Feat: 0.854 Epoch Time: 0.822 Model Time: 0.034 Data Time: 0.769 Model: 06-08_00:10_12043
Update SSL || User : 3 | Global Round : 3 | Local Epoch : 16.0 | [0/100 (0%)]	Loss: 4.876548                         LR: 0.0001  Feat: 0.855 Epoch Time: 1.758 Model Time: 0.037 Data Time: 0.820 Model: 06-08_00:10_12043
Update SSL || User : 3 | Global Round : 3 | Local Epoch : 17.0 | [0/100 (0%)]	Loss: 4.941887                         LR: 0.0001  Feat: 0.857 Epoch Time: 2.708 Model Time: 0.037 Data Time: 0.837 Model: 06-08_00:10_12043
Update SSL || User : 3 | Global Round : 3 | Local Epoch : 18.0 | [0/100 (0%)]	Loss: 4.832822                         LR: 0.0001  Feat: 0.861 Epoch Time: 3.654 Model Time: 0.035 Data Time: 0.830 Model: 06-08_00:10_12043
Update SSL || User : 3 | Global Round : 3 | Local Epoch : 19.0 | [0/100 (0%)]	Loss: 4.785114                         LR: 0.0001  Feat: 0.860 Epoch Time: 4.589 Model Time: 0.036 Data Time: 0.817 Model: 06-08_00:10_12043
New Find_phi_psi for agent:  3
Updating local model for agent:  4
Update SSL || User : 4 | Global Round : 3 | Local Epoch : 15.0 | [0/100 (0%)]	Loss: 4.969435                         LR: 0.0001  Feat: 0.844 Epoch Time: 0.878 Model Time: 0.041 Data Time: 0.822 Model: 06-08_00:10_12043
Update SSL || User : 4 | Global Round : 3 | Local Epoch : 16.0 | [0/100 (0%)]	Loss: 4.917536                         LR: 0.0001  Feat: 0.842 Epoch Time: 1.811 Model Time: 0.042 Data Time: 0.825 Model: 06-08_00:10_12043
Update SSL || User : 4 | Global Round : 3 | Local Epoch : 17.0 | [0/100 (0%)]	Loss: 4.897433                         LR: 0.0001  Feat: 0.847 Epoch Time: 2.746 Model Time: 0.029 Data Time: 0.817 Model: 06-08_00:10_12043
Update SSL || User : 4 | Global Round : 3 | Local Epoch : 18.0 | [0/100 (0%)]	Loss: 4.872004                         LR: 0.0001  Feat: 0.833 Epoch Time: 3.682 Model Time: 0.037 Data Time: 0.818 Model: 06-08_00:10_12043
Update SSL || User : 4 | Global Round : 3 | Local Epoch : 19.0 | [0/100 (0%)]	Loss: 4.879401                         LR: 0.0001  Feat: 0.845 Epoch Time: 4.583 Model Time: 0.037 Data Time: 0.790 Model: 06-08_00:10_12043
New Find_phi_psi for agent:  4
Exact Diffusion
exact_diffusion_averaging
combine_to_state_dict between 5 agents

 | Global Training Round : 5 | Model : 06-08_00:10_12043

Updating local model for agent:  0
Update SSL || User : 0 | Global Round : 4 | Local Epoch : 20.0 | [0/100 (0%)]	Loss: 4.949261                         LR: 0.0001  Feat: 0.845 Epoch Time: 0.833 Model Time: 0.037 Data Time: 0.778 Model: 06-08_00:10_12043
Update SSL || User : 0 | Global Round : 4 | Local Epoch : 21.0 | [0/100 (0%)]	Loss: 4.868822                         LR: 0.0001  Feat: 0.848 Epoch Time: 1.728 Model Time: 0.039 Data Time: 0.773 Model: 06-08_00:10_12043
Update SSL || User : 0 | Global Round : 4 | Local Epoch : 22.0 | [0/100 (0%)]	Loss: 4.702544                         LR: 0.0001  Feat: 0.851 Epoch Time: 2.648 Model Time: 0.038 Data Time: 0.808 Model: 06-08_00:10_12043
Update SSL || User : 0 | Global Round : 4 | Local Epoch : 23.0 | [0/100 (0%)]	Loss: 4.827030                         LR: 0.0001  Feat: 0.852 Epoch Time: 3.573 Model Time: 0.030 Data Time: 0.811 Model: 06-08_00:10_12043
Update SSL || User : 0 | Global Round : 4 | Local Epoch : 24.0 | [0/100 (0%)]	Loss: 4.728310                         LR: 0.0001  Feat: 0.855 Epoch Time: 4.513 Model Time: 0.034 Data Time: 0.812 Model: 06-08_00:10_12043
New Find_phi_psi for agent:  0
Updating local model for agent:  1
Update SSL || User : 1 | Global Round : 4 | Local Epoch : 20.0 | [0/100 (0%)]	Loss: 4.916483                         LR: 0.0001  Feat: 0.849 Epoch Time: 0.859 Model Time: 0.033 Data Time: 0.806 Model: 06-08_00:10_12043
Update SSL || User : 1 | Global Round : 4 | Local Epoch : 21.0 | [0/100 (0%)]	Loss: 4.926020                         LR: 0.0001  Feat: 0.855 Epoch Time: 1.794 Model Time: 0.038 Data Time: 0.819 Model: 06-08_00:10_12043
Update SSL || User : 1 | Global Round : 4 | Local Epoch : 22.0 | [0/100 (0%)]	Loss: 4.674455                         LR: 0.0001  Feat: 0.853 Epoch Time: 2.757 Model Time: 0.036 Data Time: 0.842 Model: 06-08_00:10_12043
Update SSL || User : 1 | Global Round : 4 | Local Epoch : 23.0 | [0/100 (0%)]	Loss: 4.766016                         LR: 0.0001  Feat: 0.854 Epoch Time: 3.701 Model Time: 0.037 Data Time: 0.831 Model: 06-08_00:10_12043
Update SSL || User : 1 | Global Round : 4 | Local Epoch : 24.0 | [0/100 (0%)]	Loss: 4.671072                         LR: 0.0001  Feat: 0.860 Epoch Time: 4.636 Model Time: 0.035 Data Time: 0.817 Model: 06-08_00:10_12043
New Find_phi_psi for agent:  1
Updating local model for agent:  2
Update SSL || User : 2 | Global Round : 4 | Local Epoch : 20.0 | [0/100 (0%)]	Loss: 4.912797                         LR: 0.0001  Feat: 0.846 Epoch Time: 0.894 Model Time: 0.032 Data Time: 0.840 Model: 06-08_00:10_12043
Update SSL || User : 2 | Global Round : 4 | Local Epoch : 21.0 | [0/100 (0%)]	Loss: 5.000440                         LR: 0.0001  Feat: 0.848 Epoch Time: 1.823 Model Time: 0.036 Data Time: 0.819 Model: 06-08_00:10_12043
Update SSL || User : 2 | Global Round : 4 | Local Epoch : 22.0 | [0/100 (0%)]	Loss: 4.920761                         LR: 0.0001  Feat: 0.843 Epoch Time: 2.738 Model Time: 0.030 Data Time: 0.808 Model: 06-08_00:10_12043
Update SSL || User : 2 | Global Round : 4 | Local Epoch : 23.0 | [0/100 (0%)]	Loss: 4.879146                         LR: 0.0001  Feat: 0.847 Epoch Time: 3.658 Model Time: 0.039 Data Time: 0.809 Model: 06-08_00:10_12043
Update SSL || User : 2 | Global Round : 4 | Local Epoch : 24.0 | [0/100 (0%)]	Loss: 4.807785                         LR: 0.0001  Feat: 0.852 Epoch Time: 4.583 Model Time: 0.033 Data Time: 0.809 Model: 06-08_00:10_12043
New Find_phi_psi for agent:  2
Updating local model for agent:  3
Update SSL || User : 3 | Global Round : 4 | Local Epoch : 20.0 | [0/100 (0%)]	Loss: 4.985296                         LR: 0.0001  Feat: 0.849 Epoch Time: 0.873 Model Time: 0.036 Data Time: 0.819 Model: 06-08_00:10_12043
Update SSL || User : 3 | Global Round : 4 | Local Epoch : 21.0 | [0/100 (0%)]	Loss: 4.951907                         LR: 0.0001  Feat: 0.849 Epoch Time: 1.795 Model Time: 0.031 Data Time: 0.808 Model: 06-08_00:10_12043
Update SSL || User : 3 | Global Round : 4 | Local Epoch : 22.0 | [0/100 (0%)]	Loss: 4.913897                         LR: 0.0001  Feat: 0.852 Epoch Time: 2.844 Model Time: 0.037 Data Time: 0.938 Model: 06-08_00:10_12043
Update SSL || User : 3 | Global Round : 4 | Local Epoch : 23.0 | [0/100 (0%)]	Loss: 4.797226                         LR: 0.0001  Feat: 0.852 Epoch Time: 3.793 Model Time: 0.039 Data Time: 0.827 Model: 06-08_00:10_12043
Update SSL || User : 3 | Global Round : 4 | Local Epoch : 24.0 | [0/100 (0%)]	Loss: 4.773715                         LR: 0.0001  Feat: 0.853 Epoch Time: 4.734 Model Time: 0.037 Data Time: 0.817 Model: 06-08_00:10_12043
New Find_phi_psi for agent:  3
Updating local model for agent:  4
Update SSL || User : 4 | Global Round : 4 | Local Epoch : 20.0 | [0/100 (0%)]	Loss: 4.993785                         LR: 0.0001  Feat: 0.844 Epoch Time: 0.866 Model Time: 0.040 Data Time: 0.811 Model: 06-08_00:10_12043
Update SSL || User : 4 | Global Round : 4 | Local Epoch : 21.0 | [0/100 (0%)]	Loss: 4.824733                         LR: 0.0001  Feat: 0.846 Epoch Time: 1.822 Model Time: 0.036 Data Time: 0.845 Model: 06-08_00:10_12043
Update SSL || User : 4 | Global Round : 4 | Local Epoch : 22.0 | [0/100 (0%)]	Loss: 4.851266                         LR: 0.0001  Feat: 0.841 Epoch Time: 2.769 Model Time: 0.036 Data Time: 0.840 Model: 06-08_00:10_12043
Update SSL || User : 4 | Global Round : 4 | Local Epoch : 23.0 | [0/100 (0%)]	Loss: 4.855516                         LR: 0.0001  Feat: 0.829 Epoch Time: 3.711 Model Time: 0.039 Data Time: 0.823 Model: 06-08_00:10_12043
Update SSL || User : 4 | Global Round : 4 | Local Epoch : 24.0 | [0/100 (0%)]	Loss: 4.695102                         LR: 0.0001  Feat: 0.837 Epoch Time: 4.658 Model Time: 0.041 Data Time: 0.833 Model: 06-08_00:10_12043
New Find_phi_psi for agent:  4
Exact Diffusion
exact_diffusion_averaging
combine_to_state_dict between 5 agents

 | Global Training Round : 6 | Model : 06-08_00:10_12043

Updating local model for agent:  0
Update SSL || User : 0 | Global Round : 5 | Local Epoch : 25.0 | [0/100 (0%)]	Loss: 4.930718                         LR: 0.0000  Feat: 0.841 Epoch Time: 0.860 Model Time: 0.037 Data Time: 0.804 Model: 06-08_00:10_12043
Update SSL || User : 0 | Global Round : 5 | Local Epoch : 26.0 | [0/100 (0%)]	Loss: 4.862185                         LR: 0.0000  Feat: 0.845 Epoch Time: 1.817 Model Time: 0.040 Data Time: 0.839 Model: 06-08_00:10_12043
Update SSL || User : 0 | Global Round : 5 | Local Epoch : 27.0 | [0/100 (0%)]	Loss: 4.815746                         LR: 0.0000  Feat: 0.845 Epoch Time: 2.701 Model Time: 0.039 Data Time: 0.770 Model: 06-08_00:10_12043
Update SSL || User : 0 | Global Round : 5 | Local Epoch : 28.0 | [0/100 (0%)]	Loss: 4.853568                         LR: 0.0000  Feat: 0.840 Epoch Time: 3.647 Model Time: 0.035 Data Time: 0.827 Model: 06-08_00:10_12043
Update SSL || User : 0 | Global Round : 5 | Local Epoch : 29.0 | [0/100 (0%)]	Loss: 4.952756                         LR: 0.0000  Feat: 0.839 Epoch Time: 4.587 Model Time: 0.041 Data Time: 0.826 Model: 06-08_00:10_12043
New Find_phi_psi for agent:  0
Updating local model for agent:  1
Update SSL || User : 1 | Global Round : 5 | Local Epoch : 25.0 | [0/100 (0%)]	Loss: 4.970933                         LR: 0.0000  Feat: 0.844 Epoch Time: 0.873 Model Time: 0.037 Data Time: 0.818 Model: 06-08_00:10_12043
Update SSL || User : 1 | Global Round : 5 | Local Epoch : 26.0 | [0/100 (0%)]	Loss: 4.962220                         LR: 0.0000  Feat: 0.843 Epoch Time: 1.829 Model Time: 0.039 Data Time: 0.835 Model: 06-08_00:10_12043
Update SSL || User : 1 | Global Round : 5 | Local Epoch : 27.0 | [0/100 (0%)]	Loss: 4.900360                         LR: 0.0000  Feat: 0.844 Epoch Time: 2.781 Model Time: 0.037 Data Time: 0.842 Model: 06-08_00:10_12043
Update SSL || User : 1 | Global Round : 5 | Local Epoch : 28.0 | [0/100 (0%)]	Loss: 4.864767                         LR: 0.0000  Feat: 0.846 Epoch Time: 3.733 Model Time: 0.033 Data Time: 0.844 Model: 06-08_00:10_12043
Update SSL || User : 1 | Global Round : 5 | Local Epoch : 29.0 | [0/100 (0%)]	Loss: 4.865246                         LR: 0.0000  Feat: 0.844 Epoch Time: 4.673 Model Time: 0.040 Data Time: 0.824 Model: 06-08_00:10_12043
New Find_phi_psi for agent:  1
Updating local model for agent:  2
Update SSL || User : 2 | Global Round : 5 | Local Epoch : 25.0 | [0/100 (0%)]	Loss: 4.970020                         LR: 0.0000  Feat: 0.839 Epoch Time: 0.878 Model Time: 0.041 Data Time: 0.823 Model: 06-08_00:10_12043
Update SSL || User : 2 | Global Round : 5 | Local Epoch : 26.0 | [0/100 (0%)]	Loss: 4.992622                         LR: 0.0000  Feat: 0.838 Epoch Time: 1.806 Model Time: 0.035 Data Time: 0.819 Model: 06-08_00:10_12043
Update SSL || User : 2 | Global Round : 5 | Local Epoch : 27.0 | [0/100 (0%)]	Loss: 4.861452                         LR: 0.0000  Feat: 0.843 Epoch Time: 2.764 Model Time: 0.039 Data Time: 0.830 Model: 06-08_00:10_12043
Update SSL || User : 2 | Global Round : 5 | Local Epoch : 28.0 | [0/100 (0%)]	Loss: 4.797236                         LR: 0.0000  Feat: 0.848 Epoch Time: 3.710 Model Time: 0.041 Data Time: 0.825 Model: 06-08_00:10_12043
Update SSL || User : 2 | Global Round : 5 | Local Epoch : 29.0 | [0/100 (0%)]	Loss: 4.781534                         LR: 0.0000  Feat: 0.847 Epoch Time: 4.651 Model Time: 0.041 Data Time: 0.817 Model: 06-08_00:10_12043
New Find_phi_psi for agent:  2
Updating local model for agent:  3
Update SSL || User : 3 | Global Round : 5 | Local Epoch : 25.0 | [0/100 (0%)]	Loss: 4.890673                         LR: 0.0000  Feat: 0.848 Epoch Time: 0.876 Model Time: 0.041 Data Time: 0.821 Model: 06-08_00:10_12043
Update SSL || User : 3 | Global Round : 5 | Local Epoch : 26.0 | [0/100 (0%)]	Loss: 4.766949                         LR: 0.0000  Feat: 0.847 Epoch Time: 1.816 Model Time: 0.039 Data Time: 0.822 Model: 06-08_00:10_12043
Update SSL || User : 3 | Global Round : 5 | Local Epoch : 27.0 | [0/100 (0%)]	Loss: 4.846327                         LR: 0.0000  Feat: 0.848 Epoch Time: 2.780 Model Time: 0.038 Data Time: 0.849 Model: 06-08_00:10_12043
Update SSL || User : 3 | Global Round : 5 | Local Epoch : 28.0 | [0/100 (0%)]	Loss: 4.913054                         LR: 0.0000  Feat: 0.849 Epoch Time: 3.725 Model Time: 0.035 Data Time: 0.835 Model: 06-08_00:10_12043
Update SSL || User : 3 | Global Round : 5 | Local Epoch : 29.0 | [0/100 (0%)]	Loss: 4.820219                         LR: 0.0000  Feat: 0.849 Epoch Time: 4.681 Model Time: 0.037 Data Time: 0.842 Model: 06-08_00:10_12043
New Find_phi_psi for agent:  3
Updating local model for agent:  4
Update SSL || User : 4 | Global Round : 5 | Local Epoch : 25.0 | [0/100 (0%)]	Loss: 4.899562                         LR: 0.0000  Feat: 0.843 Epoch Time: 0.887 Model Time: 0.041 Data Time: 0.832 Model: 06-08_00:10_12043
Update SSL || User : 4 | Global Round : 5 | Local Epoch : 26.0 | [0/100 (0%)]	Loss: 4.915470                         LR: 0.0000  Feat: 0.845 Epoch Time: 1.825 Model Time: 0.037 Data Time: 0.828 Model: 06-08_00:10_12043
Update SSL || User : 4 | Global Round : 5 | Local Epoch : 27.0 | [0/100 (0%)]	Loss: 4.817160                         LR: 0.0000  Feat: 0.838 Epoch Time: 2.776 Model Time: 0.037 Data Time: 0.825 Model: 06-08_00:10_12043
Update SSL || User : 4 | Global Round : 5 | Local Epoch : 28.0 | [0/100 (0%)]	Loss: 4.809830                         LR: 0.0000  Feat: 0.831 Epoch Time: 3.687 Model Time: 0.036 Data Time: 0.789 Model: 06-08_00:10_12043
Update SSL || User : 4 | Global Round : 5 | Local Epoch : 29.0 | [0/100 (0%)]	Loss: 4.792043                         LR: 0.0000  Feat: 0.840 Epoch Time: 4.626 Model Time: 0.042 Data Time: 0.818 Model: 06-08_00:10_12043
New Find_phi_psi for agent:  4
Exact Diffusion
exact_diffusion_averaging
combine_to_state_dict between 5 agents
evaluating representations:  save/06-08_00:10_12043dirich_False_dec-True_ED-True_pe0.3_a5_e30_le5.0
Training a classifier on each of the local models and averaging the accuracy result
Start tarining Classifier for user 4
Training classifier
sampling for dataset: mnist
Files already downloaded and verified
train dataset sample num: (50000, 32, 32, 3)
Files already downloaded and verified
Files already downloaded and verified
get dataset time: 2.281
Use i.i.d. sampling
Use i.i.d. sampling
sample dataset time: 0.068
user data samples: [10000, 10000, 10000, 10000, 10000]
begin training classifier...
Backbone model function:  <function resnet18 at 0x7f024f2f17e0>
Downstream Train Epoch: 1 [0/50000 (0%)]	Loss: 2.351102
Downstream Train Epoch: 1 [12800/50000 (26%)]	Loss: 2.163709
Downstream Train Epoch: 1 [25600/50000 (51%)]	Loss: 2.158439
Downstream Train Epoch: 1 [38400/50000 (77%)]	Loss: 2.062165

 Downstream Train loss: 2.1344125830397314 Acc: 0.2713
Downstream Train Epoch: 2 [0/50000 (0%)]	Loss: 2.038110
Downstream Train Epoch: 2 [12800/50000 (26%)]	Loss: 2.100680
Downstream Train Epoch: 2 [25600/50000 (51%)]	Loss: 2.016866
Downstream Train Epoch: 2 [38400/50000 (77%)]	Loss: 2.014766

 Downstream Train loss: 2.0708390802753214 Acc: 0.2871
Downstream Train Epoch: 3 [0/50000 (0%)]	Loss: 2.110709
Downstream Train Epoch: 3 [12800/50000 (26%)]	Loss: 2.085821
Downstream Train Epoch: 3 [25600/50000 (51%)]	Loss: 2.034512
Downstream Train Epoch: 3 [38400/50000 (77%)]	Loss: 1.970739

 Downstream Train loss: 2.047413089445659 Acc: 0.3235
Downstream Train Epoch: 4 [0/50000 (0%)]	Loss: 2.073936
Downstream Train Epoch: 4 [12800/50000 (26%)]	Loss: 2.043487
Downstream Train Epoch: 4 [25600/50000 (51%)]	Loss: 2.039578
Downstream Train Epoch: 4 [38400/50000 (77%)]	Loss: 2.042001

 Downstream Train loss: 2.0350415207901777 Acc: 0.3304
Downstream Train Epoch: 5 [0/50000 (0%)]	Loss: 2.050162
Downstream Train Epoch: 5 [12800/50000 (26%)]	Loss: 1.974589
Downstream Train Epoch: 5 [25600/50000 (51%)]	Loss: 2.037270
Downstream Train Epoch: 5 [38400/50000 (77%)]	Loss: 2.038830

 Downstream Train loss: 2.0268463772170398 Acc: 0.3304
Downstream Train Epoch: 6 [0/50000 (0%)]	Loss: 2.089683
Downstream Train Epoch: 6 [12800/50000 (26%)]	Loss: 1.992765
Downstream Train Epoch: 6 [25600/50000 (51%)]	Loss: 2.090276
Downstream Train Epoch: 6 [38400/50000 (77%)]	Loss: 2.082845

 Downstream Train loss: 2.0196489880279618 Acc: 0.3409
Downstream Train Epoch: 7 [0/50000 (0%)]	Loss: 2.040060
Downstream Train Epoch: 7 [12800/50000 (26%)]	Loss: 2.034441
Downstream Train Epoch: 7 [25600/50000 (51%)]	Loss: 2.012360
Downstream Train Epoch: 7 [38400/50000 (77%)]	Loss: 1.990797

 Downstream Train loss: 2.01466918782312 Acc: 0.3409
Downstream Train Epoch: 8 [0/50000 (0%)]	Loss: 1.989671
Downstream Train Epoch: 8 [12800/50000 (26%)]	Loss: 1.979758
Downstream Train Epoch: 8 [25600/50000 (51%)]	Loss: 1.976100
Downstream Train Epoch: 8 [38400/50000 (77%)]	Loss: 2.006735

 Downstream Train loss: 2.007789524234071 Acc: 0.3409
Downstream Train Epoch: 9 [0/50000 (0%)]	Loss: 1.980681
Downstream Train Epoch: 9 [12800/50000 (26%)]	Loss: 1.925068
Downstream Train Epoch: 9 [25600/50000 (51%)]	Loss: 2.027253
Downstream Train Epoch: 9 [38400/50000 (77%)]	Loss: 1.883893

 Downstream Train loss: 2.0067653230258395 Acc: 0.3409
Downstream Train Epoch: 10 [0/50000 (0%)]	Loss: 2.008940
Downstream Train Epoch: 10 [12800/50000 (26%)]	Loss: 2.048152
Downstream Train Epoch: 10 [25600/50000 (51%)]	Loss: 2.045882
Downstream Train Epoch: 10 [38400/50000 (77%)]	Loss: 1.929921

 Downstream Train loss: 2.0043037168833675 Acc: 0.3533
Downstream Train Epoch: 11 [0/50000 (0%)]	Loss: 1.988055
Downstream Train Epoch: 11 [12800/50000 (26%)]	Loss: 2.035826
Downstream Train Epoch: 11 [25600/50000 (51%)]	Loss: 2.042971
Downstream Train Epoch: 11 [38400/50000 (77%)]	Loss: 2.046101

 Downstream Train loss: 1.9990933604386387 Acc: 0.3533
Downstream Train Epoch: 12 [0/50000 (0%)]	Loss: 2.002962
Downstream Train Epoch: 12 [12800/50000 (26%)]	Loss: 2.005176
Downstream Train Epoch: 12 [25600/50000 (51%)]	Loss: 1.966579
Downstream Train Epoch: 12 [38400/50000 (77%)]	Loss: 1.957914

 Downstream Train loss: 1.9999248239458824 Acc: 0.3533
Downstream Train Epoch: 13 [0/50000 (0%)]	Loss: 1.999139
Downstream Train Epoch: 13 [12800/50000 (26%)]	Loss: 2.062115
Downstream Train Epoch: 13 [25600/50000 (51%)]	Loss: 2.036895
Downstream Train Epoch: 13 [38400/50000 (77%)]	Loss: 1.905660

 Downstream Train loss: 1.9868903835209049 Acc: 0.3533
Downstream Train Epoch: 14 [0/50000 (0%)]	Loss: 2.007561
Downstream Train Epoch: 14 [12800/50000 (26%)]	Loss: 2.011727
Downstream Train Epoch: 14 [25600/50000 (51%)]	Loss: 2.085432
Downstream Train Epoch: 14 [38400/50000 (77%)]	Loss: 1.926327

 Downstream Train loss: 1.9846925674652567 Acc: 0.3533
Downstream Train Epoch: 15 [0/50000 (0%)]	Loss: 1.998200
Downstream Train Epoch: 15 [12800/50000 (26%)]	Loss: 2.035958
Downstream Train Epoch: 15 [25600/50000 (51%)]	Loss: 2.019463
Downstream Train Epoch: 15 [38400/50000 (77%)]	Loss: 1.969196

 Downstream Train loss: 1.988451284413435 Acc: 0.3533
Downstream Train Epoch: 16 [0/50000 (0%)]	Loss: 1.971280
Downstream Train Epoch: 16 [12800/50000 (26%)]	Loss: 2.031209
Downstream Train Epoch: 16 [25600/50000 (51%)]	Loss: 1.991496
Downstream Train Epoch: 16 [38400/50000 (77%)]	Loss: 1.989834

 Downstream Train loss: 1.9856014987643884 Acc: 0.3533
Downstream Train Epoch: 17 [0/50000 (0%)]	Loss: 1.989879
Downstream Train Epoch: 17 [12800/50000 (26%)]	Loss: 1.971360
Downstream Train Epoch: 17 [25600/50000 (51%)]	Loss: 1.916233
Downstream Train Epoch: 17 [38400/50000 (77%)]	Loss: 1.944733

 Downstream Train loss: 1.984815315324433 Acc: 0.3533
Downstream Train Epoch: 18 [0/50000 (0%)]	Loss: 1.975701
Downstream Train Epoch: 18 [12800/50000 (26%)]	Loss: 1.985959
Downstream Train Epoch: 18 [25600/50000 (51%)]	Loss: 1.973971
Downstream Train Epoch: 18 [38400/50000 (77%)]	Loss: 1.961775

 Downstream Train loss: 1.982340239140452 Acc: 0.3533
Downstream Train Epoch: 19 [0/50000 (0%)]	Loss: 1.949638
Downstream Train Epoch: 19 [12800/50000 (26%)]	Loss: 1.985291
Downstream Train Epoch: 19 [25600/50000 (51%)]	Loss: 2.004193
Downstream Train Epoch: 19 [38400/50000 (77%)]	Loss: 2.011338

 Downstream Train loss: 1.9799158980651779 Acc: 0.3584
Downstream Train Epoch: 20 [0/50000 (0%)]	Loss: 1.955379
Downstream Train Epoch: 20 [12800/50000 (26%)]	Loss: 2.006157
Downstream Train Epoch: 20 [25600/50000 (51%)]	Loss: 1.928463
Downstream Train Epoch: 20 [38400/50000 (77%)]	Loss: 1.944183

 Downstream Train loss: 1.9793324123839944 Acc: 0.3584
Downstream Train Epoch: 21 [0/50000 (0%)]	Loss: 1.982158
Downstream Train Epoch: 21 [12800/50000 (26%)]	Loss: 2.021271
Downstream Train Epoch: 21 [25600/50000 (51%)]	Loss: 2.031815
Downstream Train Epoch: 21 [38400/50000 (77%)]	Loss: 1.908274

 Downstream Train loss: 1.9769097785560452 Acc: 0.3584
Downstream Train Epoch: 22 [0/50000 (0%)]	Loss: 2.075279
Downstream Train Epoch: 22 [12800/50000 (26%)]	Loss: 2.058277
Downstream Train Epoch: 22 [25600/50000 (51%)]	Loss: 1.936290
Downstream Train Epoch: 22 [38400/50000 (77%)]	Loss: 1.929908

 Downstream Train loss: 1.9781510720447617 Acc: 0.3584
Downstream Train Epoch: 23 [0/50000 (0%)]	Loss: 1.896752
Downstream Train Epoch: 23 [12800/50000 (26%)]	Loss: 1.949775
Downstream Train Epoch: 23 [25600/50000 (51%)]	Loss: 1.941927
Downstream Train Epoch: 23 [38400/50000 (77%)]	Loss: 1.924942

 Downstream Train loss: 1.977673425358169 Acc: 0.3584
Downstream Train Epoch: 24 [0/50000 (0%)]	Loss: 1.951441
Downstream Train Epoch: 24 [12800/50000 (26%)]	Loss: 1.975492
Downstream Train Epoch: 24 [25600/50000 (51%)]	Loss: 1.967031
Downstream Train Epoch: 24 [38400/50000 (77%)]	Loss: 1.936789

 Downstream Train loss: 1.97538857861441 Acc: 0.3588
Downstream Train Epoch: 25 [0/50000 (0%)]	Loss: 1.985106
Downstream Train Epoch: 25 [12800/50000 (26%)]	Loss: 2.067245
Downstream Train Epoch: 25 [25600/50000 (51%)]	Loss: 2.009591
Downstream Train Epoch: 25 [38400/50000 (77%)]	Loss: 1.997170

 Downstream Train loss: 1.9716145086045167 Acc: 0.369
Downstream Train Epoch: 26 [0/50000 (0%)]	Loss: 1.964205
Downstream Train Epoch: 26 [12800/50000 (26%)]	Loss: 2.009416
Downstream Train Epoch: 26 [25600/50000 (51%)]	Loss: 1.935808
Downstream Train Epoch: 26 [38400/50000 (77%)]	Loss: 2.029419

 Downstream Train loss: 1.9754191892487662 Acc: 0.369
Downstream Train Epoch: 27 [0/50000 (0%)]	Loss: 1.986512
Downstream Train Epoch: 27 [12800/50000 (26%)]	Loss: 1.961904
Downstream Train Epoch: 27 [25600/50000 (51%)]	Loss: 1.906386
Downstream Train Epoch: 27 [38400/50000 (77%)]	Loss: 2.064608

 Downstream Train loss: 1.9738478052372834 Acc: 0.369
Downstream Train Epoch: 28 [0/50000 (0%)]	Loss: 1.910502
Downstream Train Epoch: 28 [12800/50000 (26%)]	Loss: 2.012437
Downstream Train Epoch: 28 [25600/50000 (51%)]	Loss: 1.984799
Downstream Train Epoch: 28 [38400/50000 (77%)]	Loss: 1.997541

 Downstream Train loss: 1.967563632191444 Acc: 0.369
Downstream Train Epoch: 29 [0/50000 (0%)]	Loss: 1.886469
Downstream Train Epoch: 29 [12800/50000 (26%)]	Loss: 1.946380
Downstream Train Epoch: 29 [25600/50000 (51%)]	Loss: 1.975867
Downstream Train Epoch: 29 [38400/50000 (77%)]	Loss: 1.930871

 Downstream Train loss: 1.9687839716064686 Acc: 0.369
Downstream Train Epoch: 30 [0/50000 (0%)]	Loss: 1.907635
Downstream Train Epoch: 30 [12800/50000 (26%)]	Loss: 2.015594
Downstream Train Epoch: 30 [25600/50000 (51%)]	Loss: 1.976059
Downstream Train Epoch: 30 [38400/50000 (77%)]	Loss: 1.978185

 Downstream Train loss: 1.9701109346078367 Acc: 0.369
Downstream Train Epoch: 31 [0/50000 (0%)]	Loss: 1.938848
Downstream Train Epoch: 31 [12800/50000 (26%)]	Loss: 1.858332
Downstream Train Epoch: 31 [25600/50000 (51%)]	Loss: 1.967321
Downstream Train Epoch: 31 [38400/50000 (77%)]	Loss: 1.936789

 Downstream Train loss: 1.9684363792137223 Acc: 0.369
Downstream Train Epoch: 32 [0/50000 (0%)]	Loss: 1.946104
Downstream Train Epoch: 32 [12800/50000 (26%)]	Loss: 1.878115
Downstream Train Epoch: 32 [25600/50000 (51%)]	Loss: 1.945328
Downstream Train Epoch: 32 [38400/50000 (77%)]	Loss: 1.874544

 Downstream Train loss: 1.9625601123790353 Acc: 0.369
Downstream Train Epoch: 33 [0/50000 (0%)]	Loss: 2.028250
Downstream Train Epoch: 33 [12800/50000 (26%)]	Loss: 1.980259
Downstream Train Epoch: 33 [25600/50000 (51%)]	Loss: 1.910949
Downstream Train Epoch: 33 [38400/50000 (77%)]	Loss: 1.967256

 Downstream Train loss: 1.960027101696754 Acc: 0.369
Downstream Train Epoch: 34 [0/50000 (0%)]	Loss: 1.970297
Downstream Train Epoch: 34 [12800/50000 (26%)]	Loss: 2.090182
Downstream Train Epoch: 34 [25600/50000 (51%)]	Loss: 1.958032
Downstream Train Epoch: 34 [38400/50000 (77%)]	Loss: 1.957436

 Downstream Train loss: 1.9650674547467912 Acc: 0.369
Downstream Train Epoch: 35 [0/50000 (0%)]	Loss: 1.925706
Downstream Train Epoch: 35 [12800/50000 (26%)]	Loss: 1.964840
Downstream Train Epoch: 35 [25600/50000 (51%)]	Loss: 1.972419
Downstream Train Epoch: 35 [38400/50000 (77%)]	Loss: 2.024666

 Downstream Train loss: 1.967697327234307 Acc: 0.369
Downstream Train Epoch: 36 [0/50000 (0%)]	Loss: 1.918891
Downstream Train Epoch: 36 [12800/50000 (26%)]	Loss: 1.947007
Downstream Train Epoch: 36 [25600/50000 (51%)]	Loss: 1.961167
Downstream Train Epoch: 36 [38400/50000 (77%)]	Loss: 1.916889

 Downstream Train loss: 1.970206924847194 Acc: 0.369
Downstream Train Epoch: 37 [0/50000 (0%)]	Loss: 2.066963
Downstream Train Epoch: 37 [12800/50000 (26%)]	Loss: 1.937625
Downstream Train Epoch: 37 [25600/50000 (51%)]	Loss: 1.984611
Downstream Train Epoch: 37 [38400/50000 (77%)]	Loss: 1.973383

 Downstream Train loss: 1.9668171697733354 Acc: 0.369
Downstream Train Epoch: 38 [0/50000 (0%)]	Loss: 2.000097
Downstream Train Epoch: 38 [12800/50000 (26%)]	Loss: 1.928026
Downstream Train Epoch: 38 [25600/50000 (51%)]	Loss: 1.902942
Downstream Train Epoch: 38 [38400/50000 (77%)]	Loss: 1.964944

 Downstream Train loss: 1.9662837714565045 Acc: 0.369
Downstream Train Epoch: 39 [0/50000 (0%)]	Loss: 1.919779
Downstream Train Epoch: 39 [12800/50000 (26%)]	Loss: 1.943990
Downstream Train Epoch: 39 [25600/50000 (51%)]	Loss: 1.933018
Downstream Train Epoch: 39 [38400/50000 (77%)]	Loss: 1.934204

 Downstream Train loss: 1.966523167430138 Acc: 0.369
Downstream Train Epoch: 40 [0/50000 (0%)]	Loss: 1.965082
Downstream Train Epoch: 40 [12800/50000 (26%)]	Loss: 1.973468
Downstream Train Epoch: 40 [25600/50000 (51%)]	Loss: 2.058829
Downstream Train Epoch: 40 [38400/50000 (77%)]	Loss: 1.946347

 Downstream Train loss: 1.9599190901736825 Acc: 0.3725
Classifier Accuracy for user 4 is 0.3725
Training a classifier on the federated global model
 
 Results after 30 global rounds of training:
|----Average Classifier Test Accuracy for 5 agents is: 37.25%

 Total Run Time: 592.5523
Namespace(split_dataset=None, average_with_A=False, phi_equal_w=False, exact_diffusion=True, decentralized=True, edge_prob=0.3, epochs=30, num_users=5, frac=1.0, local_ep=5.0, local_bs=256, lr=0.001, momentum=0.9, num_workers=16, model='resnet', batch_size=256, weight_decay=0.0005, dataset='mnist', backbone='resnet18', num_classes=10, gpu='1', optimizer='adam', save_name_suffix='', iid=1, verbose=0, seed=1, feature_dim=128, temperature=0.5, k=200, ssl_method='simclr', x_noniid=False, dirichlet=False, test_intermediate=False, dir_beta=0.5, imagenet_based_cluster=False, y_partition=False, log_file_name='comm_scripts/best_linear_statistics_skew_ssl_comm.csv', num_clusters=1, imagenet100=False, y_partition_skew=False, y_partition_ratio=1, x_shift_dirichlet=False, reg_scale=1, load_pretrained_path='', full_size=False, local_rank=0, distributed_training=False, log_directory='exact_new_edge/06-08_00:09_drich-false_dec-true_ED-true_ep0.3_e30_le5_a5', emd=0, dist_url='env://', average_without_bn=False, model_continue_training=0, finetuning_epoch=40, script_name='', x_shift_skew=False, load_dataset_to_memory=False, model_time='06-08_00:10_12043', start_time=datetime.datetime(2024, 6, 8, 0, 10, 0, 626154))
dec_True_ED_True_a_5_resnet_256_30__dec_ssl_simclr
