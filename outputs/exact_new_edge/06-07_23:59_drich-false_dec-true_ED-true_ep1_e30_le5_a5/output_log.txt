
Experimental details:
    Model     : resnet
    Optimizer : adam
    Learning  : 0.001
    Global Rounds   : 30

    Fraction of users  : 1.0
    Local Batch size   : 256
    Local Epochs       : 5.0

Running model details  dirich_False_dec-True_ED-True_pe1.0_a5_e30_le5.0
device:  cuda
sampling for dataset: mnist
Downloading https://www.cs.toronto.edu/~kriz/cifar-10-python.tar.gz to data/cifar/cifar-10-python.tar.gz
Extracting data/cifar/cifar-10-python.tar.gz to data/cifar/
train dataset sample num: (50000, 32, 32, 3)
Files already downloaded and verified
Files already downloaded and verified
get dataset time: 12.519
Use i.i.d. sampling
Use i.i.d. sampling
sample dataset time: 0.065
user data samples: [10000, 10000, 10000, 10000, 10000]
Namespace(split_dataset=None, average_with_A=False, phi_equal_w=False, exact_diffusion=True, decentralized=True, edge_prob=1.0, epochs=30, num_users=5, frac=1.0, local_ep=5.0, local_bs=256, lr=0.001, momentum=0.9, num_workers=16, model='resnet', batch_size=256, weight_decay=0.0005, dataset='mnist', backbone='resnet18', num_classes=10, gpu='1', optimizer='adam', save_name_suffix='', iid=1, verbose=0, seed=1, feature_dim=128, temperature=0.5, k=200, ssl_method='simclr', x_noniid=False, dirichlet=False, test_intermediate=False, dir_beta=0.5, imagenet_based_cluster=False, y_partition=False, log_file_name='comm_scripts/best_linear_statistics_skew_ssl_comm.csv', num_clusters=1, imagenet100=False, y_partition_skew=False, y_partition_ratio=1, x_shift_dirichlet=False, reg_scale=1, load_pretrained_path='', full_size=False, local_rank=0, distributed_training=False, log_directory='exact_new_edge/06-07_23:59_drich-false_dec-true_ED-true_ep1_e30_le5_a5', emd=0, dist_url='env://', average_without_bn=False, model_continue_training=0, finetuning_epoch=40, script_name='', x_shift_skew=False, load_dataset_to_memory=False)
Backbone model function:  <function resnet18 at 0x7f3ff26f16c0>
Backbone model function:  <function resnet18 at 0x7f3ff26f16c0>
Backbone model function:  <function resnet18 at 0x7f3ff26f16c0>
Backbone model function:  <function resnet18 at 0x7f3ff26f16c0>
Backbone model function:  <function resnet18 at 0x7f3ff26f16c0>
Backbone model function:  <function resnet18 at 0x7f3ff26f16c0>
output model: save/06-07_23:59_2449dirich_False_dec-True_ED-True_pe1.0_a5_e30_le5.0
number of users per round: 5
total number of rounds: 6
Training uses 0.01 andd validation 0.010000000000000009 of the dataset
idx train:  100
Training uses 0.01 andd validation 0.010000000000000009 of the dataset
idx train:  100
Training uses 0.01 andd validation 0.010000000000000009 of the dataset
idx train:  100
Training uses 0.01 andd validation 0.010000000000000009 of the dataset
idx train:  100
Training uses 0.01 andd validation 0.010000000000000009 of the dataset
idx train:  100
attempted matrix  [[0. 1. 1. 1. 1.]
 [1. 0. 1. 1. 1.]
 [1. 1. 0. 1. 1.]
 [1. 1. 1. 0. 1.]
 [1. 1. 1. 1. 0.]]
successful matrix  [[0. 1. 1. 1. 1.]
 [1. 0. 1. 1. 1.]
 [1. 1. 0. 1. 1.]
 [1. 1. 1. 0. 1.]
 [1. 1. 1. 1. 0.]]
5.0
5.0
5.0
5.0
5.0
5.0
5.0
5.0
5.0
5.0
matrix A  [[0.2 0.2 0.2 0.2 0.2]
 [0.2 0.2 0.2 0.2 0.2]
 [0.2 0.2 0.2 0.2 0.2]
 [0.2 0.2 0.2 0.2 0.2]
 [0.2 0.2 0.2 0.2 0.2]]
Second Eigenvalue of A:  -2.4887931835784534e-17
Createda a Communication graph with edges = :  [(0, 1), (0, 2), (0, 3), (0, 4), (1, 2), (1, 3), (1, 4), (2, 3), (2, 4), (3, 4)]
Number of edges:  10
Graph nodes:  [0, 1, 2, 3, 4]

 | Global Training Round : 1 | Model : 06-07_23:59_2449

Updating local model for agent:  0
Update SSL || User : 0 | Global Round : 0 | Local Epoch : 0.0 | [0/100 (0%)]	Loss: 5.153934                         LR: 0.0010  Feat: 0.775 Epoch Time: 3.230 Model Time: 1.630 Data Time: 1.600 Model: 06-07_23:59_2449
Update SSL || User : 0 | Global Round : 0 | Local Epoch : 1.0 | [0/100 (0%)]	Loss: 5.097200                         LR: 0.0010  Feat: 0.776 Epoch Time: 4.191 Model Time: 0.039 Data Time: 0.860 Model: 06-07_23:59_2449
Update SSL || User : 0 | Global Round : 0 | Local Epoch : 2.0 | [0/100 (0%)]	Loss: 4.870822                         LR: 0.0010  Feat: 0.786 Epoch Time: 5.194 Model Time: 0.035 Data Time: 0.882 Model: 06-07_23:59_2449
Update SSL || User : 0 | Global Round : 0 | Local Epoch : 3.0 | [0/100 (0%)]	Loss: 4.853003                         LR: 0.0010  Feat: 0.783 Epoch Time: 6.196 Model Time: 0.039 Data Time: 0.886 Model: 06-07_23:59_2449
Update SSL || User : 0 | Global Round : 0 | Local Epoch : 4.0 | [0/100 (0%)]	Loss: 4.941356                         LR: 0.0010  Feat: 0.773 Epoch Time: 7.191 Model Time: 0.039 Data Time: 0.882 Model: 06-07_23:59_2449
New Find_phi_psi for agent:  0
Updating local model for agent:  1
Update SSL || User : 1 | Global Round : 0 | Local Epoch : 0.0 | [0/100 (0%)]	Loss: 5.205070                         LR: 0.0010  Feat: 0.776 Epoch Time: 0.862 Model Time: 0.045 Data Time: 0.805 Model: 06-07_23:59_2449
Update SSL || User : 1 | Global Round : 0 | Local Epoch : 1.0 | [0/100 (0%)]	Loss: 5.126121                         LR: 0.0010  Feat: 0.799 Epoch Time: 1.801 Model Time: 0.035 Data Time: 0.815 Model: 06-07_23:59_2449
Update SSL || User : 1 | Global Round : 0 | Local Epoch : 2.0 | [0/100 (0%)]	Loss: 5.119077                         LR: 0.0010  Feat: 0.824 Epoch Time: 2.750 Model Time: 0.034 Data Time: 0.844 Model: 06-07_23:59_2449
Update SSL || User : 1 | Global Round : 0 | Local Epoch : 3.0 | [0/100 (0%)]	Loss: 4.931034                         LR: 0.0010  Feat: 0.856 Epoch Time: 3.735 Model Time: 0.037 Data Time: 0.876 Model: 06-07_23:59_2449
Update SSL || User : 1 | Global Round : 0 | Local Epoch : 4.0 | [0/100 (0%)]	Loss: 4.824443                         LR: 0.0010  Feat: 0.865 Epoch Time: 4.753 Model Time: 0.038 Data Time: 0.897 Model: 06-07_23:59_2449
New Find_phi_psi for agent:  1
Updating local model for agent:  2
Update SSL || User : 2 | Global Round : 0 | Local Epoch : 0.0 | [0/100 (0%)]	Loss: 5.169698                         LR: 0.0010  Feat: 0.779 Epoch Time: 0.922 Model Time: 0.043 Data Time: 0.868 Model: 06-07_23:59_2449
Update SSL || User : 2 | Global Round : 0 | Local Epoch : 1.0 | [0/100 (0%)]	Loss: 5.093655                         LR: 0.0010  Feat: 0.792 Epoch Time: 1.912 Model Time: 0.032 Data Time: 0.871 Model: 06-07_23:59_2449
Update SSL || User : 2 | Global Round : 0 | Local Epoch : 2.0 | [0/100 (0%)]	Loss: 5.031906                         LR: 0.0010  Feat: 0.820 Epoch Time: 2.892 Model Time: 0.040 Data Time: 0.870 Model: 06-07_23:59_2449
Update SSL || User : 2 | Global Round : 0 | Local Epoch : 3.0 | [0/100 (0%)]	Loss: 4.821356                         LR: 0.0010  Feat: 0.840 Epoch Time: 3.825 Model Time: 0.038 Data Time: 0.805 Model: 06-07_23:59_2449
Update SSL || User : 2 | Global Round : 0 | Local Epoch : 4.0 | [0/100 (0%)]	Loss: 4.833871                         LR: 0.0010  Feat: 0.846 Epoch Time: 4.772 Model Time: 0.035 Data Time: 0.830 Model: 06-07_23:59_2449
New Find_phi_psi for agent:  2
Updating local model for agent:  3
Update SSL || User : 3 | Global Round : 0 | Local Epoch : 0.0 | [0/100 (0%)]	Loss: 5.256113                         LR: 0.0010  Feat: 0.772 Epoch Time: 0.903 Model Time: 0.042 Data Time: 0.846 Model: 06-07_23:59_2449
Update SSL || User : 3 | Global Round : 0 | Local Epoch : 1.0 | [0/100 (0%)]	Loss: 5.166593                         LR: 0.0010  Feat: 0.792 Epoch Time: 1.896 Model Time: 0.047 Data Time: 0.862 Model: 06-07_23:59_2449
Update SSL || User : 3 | Global Round : 0 | Local Epoch : 2.0 | [0/100 (0%)]	Loss: 5.077226                         LR: 0.0010  Feat: 0.790 Epoch Time: 2.877 Model Time: 0.039 Data Time: 0.864 Model: 06-07_23:59_2449
Update SSL || User : 3 | Global Round : 0 | Local Epoch : 3.0 | [0/100 (0%)]	Loss: 4.987803                         LR: 0.0010  Feat: 0.825 Epoch Time: 3.812 Model Time: 0.035 Data Time: 0.825 Model: 06-07_23:59_2449
Update SSL || User : 3 | Global Round : 0 | Local Epoch : 4.0 | [0/100 (0%)]	Loss: 4.919300                         LR: 0.0010  Feat: 0.832 Epoch Time: 4.793 Model Time: 0.034 Data Time: 0.867 Model: 06-07_23:59_2449
New Find_phi_psi for agent:  3
Updating local model for agent:  4
Update SSL || User : 4 | Global Round : 0 | Local Epoch : 0.0 | [0/100 (0%)]	Loss: 5.179138                         LR: 0.0010  Feat: 0.772 Epoch Time: 0.901 Model Time: 0.044 Data Time: 0.845 Model: 06-07_23:59_2449
Update SSL || User : 4 | Global Round : 0 | Local Epoch : 1.0 | [0/100 (0%)]	Loss: 5.066868                         LR: 0.0010  Feat: 0.771 Epoch Time: 1.885 Model Time: 0.039 Data Time: 0.868 Model: 06-07_23:59_2449
Update SSL || User : 4 | Global Round : 0 | Local Epoch : 2.0 | [0/100 (0%)]	Loss: 4.992040                         LR: 0.0010  Feat: 0.815 Epoch Time: 2.846 Model Time: 0.036 Data Time: 0.843 Model: 06-07_23:59_2449
Update SSL || User : 4 | Global Round : 0 | Local Epoch : 3.0 | [0/100 (0%)]	Loss: 4.972530                         LR: 0.0010  Feat: 0.789 Epoch Time: 3.836 Model Time: 0.035 Data Time: 0.875 Model: 06-07_23:59_2449
Update SSL || User : 4 | Global Round : 0 | Local Epoch : 4.0 | [0/100 (0%)]	Loss: 4.844021                         LR: 0.0010  Feat: 0.779 Epoch Time: 4.826 Model Time: 0.037 Data Time: 0.881 Model: 06-07_23:59_2449
New Find_phi_psi for agent:  4
Exact Diffusion
exact_diffusion_averaging
combine_to_state_dict between 5 agents

 | Global Training Round : 2 | Model : 06-07_23:59_2449

Updating local model for agent:  0
Update SSL || User : 0 | Global Round : 1 | Local Epoch : 5.0 | [0/100 (0%)]	Loss: 5.178330                         LR: 0.0003  Feat: 0.827 Epoch Time: 0.921 Model Time: 0.033 Data Time: 0.867 Model: 06-07_23:59_2449
Update SSL || User : 0 | Global Round : 1 | Local Epoch : 6.0 | [0/100 (0%)]	Loss: 5.083071                         LR: 0.0003  Feat: 0.827 Epoch Time: 1.925 Model Time: 0.038 Data Time: 0.894 Model: 06-07_23:59_2449
Update SSL || User : 0 | Global Round : 1 | Local Epoch : 7.0 | [0/100 (0%)]	Loss: 5.117896                         LR: 0.0003  Feat: 0.827 Epoch Time: 2.932 Model Time: 0.039 Data Time: 0.897 Model: 06-07_23:59_2449
Update SSL || User : 0 | Global Round : 1 | Local Epoch : 8.0 | [0/100 (0%)]	Loss: 4.744331                         LR: 0.0003  Feat: 0.854 Epoch Time: 3.919 Model Time: 0.034 Data Time: 0.870 Model: 06-07_23:59_2449
Update SSL || User : 0 | Global Round : 1 | Local Epoch : 9.0 | [0/100 (0%)]	Loss: 4.871525                         LR: 0.0003  Feat: 0.852 Epoch Time: 4.875 Model Time: 0.037 Data Time: 0.826 Model: 06-07_23:59_2449
New Find_phi_psi for agent:  0
Updating local model for agent:  1
Update SSL || User : 1 | Global Round : 1 | Local Epoch : 5.0 | [0/100 (0%)]	Loss: 5.151591                         LR: 0.0003  Feat: 0.829 Epoch Time: 0.939 Model Time: 0.034 Data Time: 0.884 Model: 06-07_23:59_2449
Update SSL || User : 1 | Global Round : 1 | Local Epoch : 6.0 | [0/100 (0%)]	Loss: 5.002452                         LR: 0.0003  Feat: 0.836 Epoch Time: 1.933 Model Time: 0.042 Data Time: 0.865 Model: 06-07_23:59_2449
Update SSL || User : 1 | Global Round : 1 | Local Epoch : 7.0 | [0/100 (0%)]	Loss: 4.926354                         LR: 0.0003  Feat: 0.851 Epoch Time: 2.923 Model Time: 0.041 Data Time: 0.872 Model: 06-07_23:59_2449
Update SSL || User : 1 | Global Round : 1 | Local Epoch : 8.0 | [0/100 (0%)]	Loss: 4.963512                         LR: 0.0003  Feat: 0.844 Epoch Time: 3.892 Model Time: 0.042 Data Time: 0.836 Model: 06-07_23:59_2449
Update SSL || User : 1 | Global Round : 1 | Local Epoch : 9.0 | [0/100 (0%)]	Loss: 4.800589                         LR: 0.0003  Feat: 0.866 Epoch Time: 4.886 Model Time: 0.040 Data Time: 0.868 Model: 06-07_23:59_2449
New Find_phi_psi for agent:  1
Updating local model for agent:  2
Update SSL || User : 2 | Global Round : 1 | Local Epoch : 5.0 | [0/100 (0%)]	Loss: 5.261608                         LR: 0.0003  Feat: 0.819 Epoch Time: 0.900 Model Time: 0.045 Data Time: 0.841 Model: 06-07_23:59_2449
Update SSL || User : 2 | Global Round : 1 | Local Epoch : 6.0 | [0/100 (0%)]	Loss: 4.988124                         LR: 0.0003  Feat: 0.838 Epoch Time: 1.928 Model Time: 0.040 Data Time: 0.903 Model: 06-07_23:59_2449
Update SSL || User : 2 | Global Round : 1 | Local Epoch : 7.0 | [0/100 (0%)]	Loss: 5.011073                         LR: 0.0003  Feat: 0.849 Epoch Time: 2.932 Model Time: 0.031 Data Time: 0.895 Model: 06-07_23:59_2449
Update SSL || User : 2 | Global Round : 1 | Local Epoch : 8.0 | [0/100 (0%)]	Loss: 4.910458                         LR: 0.0003  Feat: 0.858 Epoch Time: 3.935 Model Time: 0.038 Data Time: 0.874 Model: 06-07_23:59_2449
Update SSL || User : 2 | Global Round : 1 | Local Epoch : 9.0 | [0/100 (0%)]	Loss: 4.758566                         LR: 0.0003  Feat: 0.864 Epoch Time: 4.932 Model Time: 0.038 Data Time: 0.889 Model: 06-07_23:59_2449
New Find_phi_psi for agent:  2
Updating local model for agent:  3
Update SSL || User : 3 | Global Round : 1 | Local Epoch : 5.0 | [0/100 (0%)]	Loss: 5.194449                         LR: 0.0003  Feat: 0.831 Epoch Time: 0.950 Model Time: 0.032 Data Time: 0.896 Model: 06-07_23:59_2449
Update SSL || User : 3 | Global Round : 1 | Local Epoch : 6.0 | [0/100 (0%)]	Loss: 5.046548                         LR: 0.0003  Feat: 0.841 Epoch Time: 1.932 Model Time: 0.041 Data Time: 0.859 Model: 06-07_23:59_2449
Update SSL || User : 3 | Global Round : 1 | Local Epoch : 7.0 | [0/100 (0%)]	Loss: 4.909835                         LR: 0.0003  Feat: 0.847 Epoch Time: 2.914 Model Time: 0.041 Data Time: 0.860 Model: 06-07_23:59_2449
Update SSL || User : 3 | Global Round : 1 | Local Epoch : 8.0 | [0/100 (0%)]	Loss: 4.942640                         LR: 0.0003  Feat: 0.854 Epoch Time: 3.899 Model Time: 0.034 Data Time: 0.871 Model: 06-07_23:59_2449
Update SSL || User : 3 | Global Round : 1 | Local Epoch : 9.0 | [0/100 (0%)]	Loss: 4.900742                         LR: 0.0003  Feat: 0.864 Epoch Time: 4.880 Model Time: 0.036 Data Time: 0.868 Model: 06-07_23:59_2449
New Find_phi_psi for agent:  3
Updating local model for agent:  4
Update SSL || User : 4 | Global Round : 1 | Local Epoch : 5.0 | [0/100 (0%)]	Loss: 5.150892                         LR: 0.0003  Feat: 0.816 Epoch Time: 0.907 Model Time: 0.034 Data Time: 0.854 Model: 06-07_23:59_2449
Update SSL || User : 4 | Global Round : 1 | Local Epoch : 6.0 | [0/100 (0%)]	Loss: 5.118295                         LR: 0.0003  Feat: 0.840 Epoch Time: 1.941 Model Time: 0.037 Data Time: 0.909 Model: 06-07_23:59_2449
Update SSL || User : 4 | Global Round : 1 | Local Epoch : 7.0 | [0/100 (0%)]	Loss: 4.847548                         LR: 0.0003  Feat: 0.845 Epoch Time: 2.932 Model Time: 0.035 Data Time: 0.879 Model: 06-07_23:59_2449
Update SSL || User : 4 | Global Round : 1 | Local Epoch : 8.0 | [0/100 (0%)]	Loss: 4.907089                         LR: 0.0003  Feat: 0.855 Epoch Time: 3.867 Model Time: 0.038 Data Time: 0.826 Model: 06-07_23:59_2449
Update SSL || User : 4 | Global Round : 1 | Local Epoch : 9.0 | [0/100 (0%)]	Loss: 4.659523                         LR: 0.0003  Feat: 0.848 Epoch Time: 4.827 Model Time: 0.035 Data Time: 0.848 Model: 06-07_23:59_2449
New Find_phi_psi for agent:  4
Exact Diffusion
exact_diffusion_averaging
combine_to_state_dict between 5 agents

 | Global Training Round : 3 | Model : 06-07_23:59_2449

Updating local model for agent:  0
Update SSL || User : 0 | Global Round : 2 | Local Epoch : 10.0 | [0/100 (0%)]	Loss: 4.808280                         LR: 0.0003  Feat: 0.857 Epoch Time: 0.890 Model Time: 0.043 Data Time: 0.835 Model: 06-07_23:59_2449
Update SSL || User : 0 | Global Round : 2 | Local Epoch : 11.0 | [0/100 (0%)]	Loss: 4.788490                         LR: 0.0003  Feat: 0.845 Epoch Time: 1.906 Model Time: 0.040 Data Time: 0.883 Model: 06-07_23:59_2449
Update SSL || User : 0 | Global Round : 2 | Local Epoch : 12.0 | [0/100 (0%)]	Loss: 4.772863                         LR: 0.0003  Feat: 0.843 Epoch Time: 2.929 Model Time: 0.037 Data Time: 0.895 Model: 06-07_23:59_2449
Update SSL || User : 0 | Global Round : 2 | Local Epoch : 13.0 | [0/100 (0%)]	Loss: 4.935829                         LR: 0.0003  Feat: 0.860 Epoch Time: 3.953 Model Time: 0.037 Data Time: 0.907 Model: 06-07_23:59_2449
Update SSL || User : 0 | Global Round : 2 | Local Epoch : 14.0 | [0/100 (0%)]	Loss: 4.830749                         LR: 0.0003  Feat: 0.863 Epoch Time: 4.944 Model Time: 0.036 Data Time: 0.867 Model: 06-07_23:59_2449
New Find_phi_psi for agent:  0
Updating local model for agent:  1
Update SSL || User : 1 | Global Round : 2 | Local Epoch : 10.0 | [0/100 (0%)]	Loss: 4.787586                         LR: 0.0003  Feat: 0.860 Epoch Time: 0.920 Model Time: 0.036 Data Time: 0.866 Model: 06-07_23:59_2449
Update SSL || User : 1 | Global Round : 2 | Local Epoch : 11.0 | [0/100 (0%)]	Loss: 4.782266                         LR: 0.0003  Feat: 0.857 Epoch Time: 1.910 Model Time: 0.035 Data Time: 0.871 Model: 06-07_23:59_2449
Update SSL || User : 1 | Global Round : 2 | Local Epoch : 12.0 | [0/100 (0%)]	Loss: 4.908111                         LR: 0.0003  Feat: 0.847 Epoch Time: 2.905 Model Time: 0.037 Data Time: 0.871 Model: 06-07_23:59_2449
Update SSL || User : 1 | Global Round : 2 | Local Epoch : 13.0 | [0/100 (0%)]	Loss: 4.658092                         LR: 0.0003  Feat: 0.861 Epoch Time: 3.896 Model Time: 0.031 Data Time: 0.863 Model: 06-07_23:59_2449
Update SSL || User : 1 | Global Round : 2 | Local Epoch : 14.0 | [0/100 (0%)]	Loss: 4.760138                         LR: 0.0003  Feat: 0.873 Epoch Time: 4.900 Model Time: 0.037 Data Time: 0.893 Model: 06-07_23:59_2449
New Find_phi_psi for agent:  1
Updating local model for agent:  2
Update SSL || User : 2 | Global Round : 2 | Local Epoch : 10.0 | [0/100 (0%)]	Loss: 4.871044                         LR: 0.0003  Feat: 0.844 Epoch Time: 0.924 Model Time: 0.042 Data Time: 0.869 Model: 06-07_23:59_2449
Update SSL || User : 2 | Global Round : 2 | Local Epoch : 11.0 | [0/100 (0%)]	Loss: 4.850056                         LR: 0.0003  Feat: 0.854 Epoch Time: 1.896 Model Time: 0.033 Data Time: 0.863 Model: 06-07_23:59_2449
Update SSL || User : 2 | Global Round : 2 | Local Epoch : 12.0 | [0/100 (0%)]	Loss: 4.890294                         LR: 0.0003  Feat: 0.849 Epoch Time: 2.862 Model Time: 0.030 Data Time: 0.857 Model: 06-07_23:59_2449
Update SSL || User : 2 | Global Round : 2 | Local Epoch : 13.0 | [0/100 (0%)]	Loss: 4.649081                         LR: 0.0003  Feat: 0.862 Epoch Time: 3.858 Model Time: 0.038 Data Time: 0.873 Model: 06-07_23:59_2449
Update SSL || User : 2 | Global Round : 2 | Local Epoch : 14.0 | [0/100 (0%)]	Loss: 4.785287                         LR: 0.0003  Feat: 0.868 Epoch Time: 4.851 Model Time: 0.039 Data Time: 0.873 Model: 06-07_23:59_2449
New Find_phi_psi for agent:  2
Updating local model for agent:  3
Update SSL || User : 3 | Global Round : 2 | Local Epoch : 10.0 | [0/100 (0%)]	Loss: 4.875839                         LR: 0.0003  Feat: 0.859 Epoch Time: 0.933 Model Time: 0.037 Data Time: 0.879 Model: 06-07_23:59_2449
Update SSL || User : 3 | Global Round : 2 | Local Epoch : 11.0 | [0/100 (0%)]	Loss: 5.038765                         LR: 0.0003  Feat: 0.851 Epoch Time: 1.886 Model Time: 0.039 Data Time: 0.836 Model: 06-07_23:59_2449
Update SSL || User : 3 | Global Round : 2 | Local Epoch : 12.0 | [0/100 (0%)]	Loss: 4.797637                         LR: 0.0003  Feat: 0.854 Epoch Time: 2.849 Model Time: 0.037 Data Time: 0.849 Model: 06-07_23:59_2449
Update SSL || User : 3 | Global Round : 2 | Local Epoch : 13.0 | [0/100 (0%)]	Loss: 4.862105                         LR: 0.0003  Feat: 0.868 Epoch Time: 3.868 Model Time: 0.038 Data Time: 0.905 Model: 06-07_23:59_2449
Update SSL || User : 3 | Global Round : 2 | Local Epoch : 14.0 | [0/100 (0%)]	Loss: 4.769374                         LR: 0.0003  Feat: 0.876 Epoch Time: 4.896 Model Time: 0.042 Data Time: 0.911 Model: 06-07_23:59_2449
New Find_phi_psi for agent:  3
Updating local model for agent:  4
Update SSL || User : 4 | Global Round : 2 | Local Epoch : 10.0 | [0/100 (0%)]	Loss: 4.870110                         LR: 0.0003  Feat: 0.845 Epoch Time: 0.933 Model Time: 0.037 Data Time: 0.878 Model: 06-07_23:59_2449
Update SSL || User : 4 | Global Round : 2 | Local Epoch : 11.0 | [0/100 (0%)]	Loss: 4.877548                         LR: 0.0003  Feat: 0.794 Epoch Time: 1.950 Model Time: 0.037 Data Time: 0.887 Model: 06-07_23:59_2449
Update SSL || User : 4 | Global Round : 2 | Local Epoch : 12.0 | [0/100 (0%)]	Loss: 4.835996                         LR: 0.0003  Feat: 0.816 Epoch Time: 2.930 Model Time: 0.035 Data Time: 0.869 Model: 06-07_23:59_2449
Update SSL || User : 4 | Global Round : 2 | Local Epoch : 13.0 | [0/100 (0%)]	Loss: 4.895097                         LR: 0.0003  Feat: 0.820 Epoch Time: 3.908 Model Time: 0.034 Data Time: 0.865 Model: 06-07_23:59_2449
Update SSL || User : 4 | Global Round : 2 | Local Epoch : 14.0 | [0/100 (0%)]	Loss: 4.849213                         LR: 0.0003  Feat: 0.803 Epoch Time: 4.869 Model Time: 0.031 Data Time: 0.833 Model: 06-07_23:59_2449
New Find_phi_psi for agent:  4
Exact Diffusion
exact_diffusion_averaging
combine_to_state_dict between 5 agents

 | Global Training Round : 4 | Model : 06-07_23:59_2449

Updating local model for agent:  0
Update SSL || User : 0 | Global Round : 3 | Local Epoch : 15.0 | [0/100 (0%)]	Loss: 4.685645                         LR: 0.0001  Feat: 0.851 Epoch Time: 0.872 Model Time: 0.041 Data Time: 0.817 Model: 06-07_23:59_2449
Update SSL || User : 0 | Global Round : 3 | Local Epoch : 16.0 | [0/100 (0%)]	Loss: 4.679455                         LR: 0.0001  Feat: 0.862 Epoch Time: 1.852 Model Time: 0.042 Data Time: 0.856 Model: 06-07_23:59_2449
Update SSL || User : 0 | Global Round : 3 | Local Epoch : 17.0 | [0/100 (0%)]	Loss: 4.638123                         LR: 0.0001  Feat: 0.867 Epoch Time: 2.842 Model Time: 0.029 Data Time: 0.860 Model: 06-07_23:59_2449
Update SSL || User : 0 | Global Round : 3 | Local Epoch : 18.0 | [0/100 (0%)]	Loss: 4.802319                         LR: 0.0001  Feat: 0.871 Epoch Time: 3.803 Model Time: 0.040 Data Time: 0.854 Model: 06-07_23:59_2449
Update SSL || User : 0 | Global Round : 3 | Local Epoch : 19.0 | [0/100 (0%)]	Loss: 4.793336                         LR: 0.0001  Feat: 0.871 Epoch Time: 4.805 Model Time: 0.029 Data Time: 0.872 Model: 06-07_23:59_2449
New Find_phi_psi for agent:  0
Updating local model for agent:  1
Update SSL || User : 1 | Global Round : 3 | Local Epoch : 15.0 | [0/100 (0%)]	Loss: 4.640591                         LR: 0.0001  Feat: 0.852 Epoch Time: 0.934 Model Time: 0.042 Data Time: 0.878 Model: 06-07_23:59_2449
Update SSL || User : 1 | Global Round : 3 | Local Epoch : 16.0 | [0/100 (0%)]	Loss: 4.551792                         LR: 0.0001  Feat: 0.864 Epoch Time: 1.930 Model Time: 0.037 Data Time: 0.875 Model: 06-07_23:59_2449
Update SSL || User : 1 | Global Round : 3 | Local Epoch : 17.0 | [0/100 (0%)]	Loss: 4.748394                         LR: 0.0001  Feat: 0.868 Epoch Time: 2.920 Model Time: 0.029 Data Time: 0.860 Model: 06-07_23:59_2449
Update SSL || User : 1 | Global Round : 3 | Local Epoch : 18.0 | [0/100 (0%)]	Loss: 4.561164                         LR: 0.0001  Feat: 0.867 Epoch Time: 3.912 Model Time: 0.040 Data Time: 0.869 Model: 06-07_23:59_2449
Update SSL || User : 1 | Global Round : 3 | Local Epoch : 19.0 | [0/100 (0%)]	Loss: 4.724361                         LR: 0.0001  Feat: 0.864 Epoch Time: 4.876 Model Time: 0.037 Data Time: 0.847 Model: 06-07_23:59_2449
New Find_phi_psi for agent:  1
Updating local model for agent:  2
Update SSL || User : 2 | Global Round : 3 | Local Epoch : 15.0 | [0/100 (0%)]	Loss: 4.670748                         LR: 0.0001  Feat: 0.851 Epoch Time: 0.903 Model Time: 0.040 Data Time: 0.849 Model: 06-07_23:59_2449
Update SSL || User : 2 | Global Round : 3 | Local Epoch : 16.0 | [0/100 (0%)]	Loss: 4.602473                         LR: 0.0001  Feat: 0.860 Epoch Time: 1.888 Model Time: 0.029 Data Time: 0.864 Model: 06-07_23:59_2449
Update SSL || User : 2 | Global Round : 3 | Local Epoch : 17.0 | [0/100 (0%)]	Loss: 4.687675                         LR: 0.0001  Feat: 0.867 Epoch Time: 2.878 Model Time: 0.030 Data Time: 0.868 Model: 06-07_23:59_2449
Update SSL || User : 2 | Global Round : 3 | Local Epoch : 18.0 | [0/100 (0%)]	Loss: 4.518872                         LR: 0.0001  Feat: 0.862 Epoch Time: 3.850 Model Time: 0.034 Data Time: 0.849 Model: 06-07_23:59_2449
Update SSL || User : 2 | Global Round : 3 | Local Epoch : 19.0 | [0/100 (0%)]	Loss: 4.596490                         LR: 0.0001  Feat: 0.864 Epoch Time: 4.816 Model Time: 0.040 Data Time: 0.851 Model: 06-07_23:59_2449
New Find_phi_psi for agent:  2
Updating local model for agent:  3
Update SSL || User : 3 | Global Round : 3 | Local Epoch : 15.0 | [0/100 (0%)]	Loss: 4.671517                         LR: 0.0001  Feat: 0.863 Epoch Time: 0.913 Model Time: 0.043 Data Time: 0.855 Model: 06-07_23:59_2449
Update SSL || User : 3 | Global Round : 3 | Local Epoch : 16.0 | [0/100 (0%)]	Loss: 4.562059                         LR: 0.0001  Feat: 0.865 Epoch Time: 1.920 Model Time: 0.039 Data Time: 0.883 Model: 06-07_23:59_2449
Update SSL || User : 3 | Global Round : 3 | Local Epoch : 17.0 | [0/100 (0%)]	Loss: 4.723830                         LR: 0.0001  Feat: 0.874 Epoch Time: 2.917 Model Time: 0.037 Data Time: 0.877 Model: 06-07_23:59_2449
Update SSL || User : 3 | Global Round : 3 | Local Epoch : 18.0 | [0/100 (0%)]	Loss: 4.698202                         LR: 0.0001  Feat: 0.875 Epoch Time: 3.910 Model Time: 0.032 Data Time: 0.868 Model: 06-07_23:59_2449
Update SSL || User : 3 | Global Round : 3 | Local Epoch : 19.0 | [0/100 (0%)]	Loss: 4.681493                         LR: 0.0001  Feat: 0.871 Epoch Time: 4.871 Model Time: 0.038 Data Time: 0.847 Model: 06-07_23:59_2449
New Find_phi_psi for agent:  3
Updating local model for agent:  4
Update SSL || User : 4 | Global Round : 3 | Local Epoch : 15.0 | [0/100 (0%)]	Loss: 4.705530                         LR: 0.0001  Feat: 0.850 Epoch Time: 0.916 Model Time: 0.038 Data Time: 0.860 Model: 06-07_23:59_2449
Update SSL || User : 4 | Global Round : 3 | Local Epoch : 16.0 | [0/100 (0%)]	Loss: 4.628789                         LR: 0.0001  Feat: 0.852 Epoch Time: 1.905 Model Time: 0.036 Data Time: 0.867 Model: 06-07_23:59_2449
Update SSL || User : 4 | Global Round : 3 | Local Epoch : 17.0 | [0/100 (0%)]	Loss: 4.817067                         LR: 0.0001  Feat: 0.855 Epoch Time: 2.889 Model Time: 0.035 Data Time: 0.856 Model: 06-07_23:59_2449
Update SSL || User : 4 | Global Round : 3 | Local Epoch : 18.0 | [0/100 (0%)]	Loss: 4.681798                         LR: 0.0001  Feat: 0.830 Epoch Time: 3.878 Model Time: 0.038 Data Time: 0.863 Model: 06-07_23:59_2449
Update SSL || User : 4 | Global Round : 3 | Local Epoch : 19.0 | [0/100 (0%)]	Loss: 4.730083                         LR: 0.0001  Feat: 0.863 Epoch Time: 4.837 Model Time: 0.038 Data Time: 0.848 Model: 06-07_23:59_2449
New Find_phi_psi for agent:  4
Exact Diffusion
exact_diffusion_averaging
combine_to_state_dict between 5 agents

 | Global Training Round : 5 | Model : 06-07_23:59_2449

Updating local model for agent:  0
Update SSL || User : 0 | Global Round : 4 | Local Epoch : 20.0 | [0/100 (0%)]	Loss: 4.606757                         LR: 0.0001  Feat: 0.866 Epoch Time: 0.880 Model Time: 0.041 Data Time: 0.824 Model: 06-07_23:59_2449
Update SSL || User : 0 | Global Round : 4 | Local Epoch : 21.0 | [0/100 (0%)]	Loss: 4.574476                         LR: 0.0001  Feat: 0.868 Epoch Time: 1.847 Model Time: 0.038 Data Time: 0.860 Model: 06-07_23:59_2449
Update SSL || User : 0 | Global Round : 4 | Local Epoch : 22.0 | [0/100 (0%)]	Loss: 4.493077                         LR: 0.0001  Feat: 0.866 Epoch Time: 2.818 Model Time: 0.032 Data Time: 0.857 Model: 06-07_23:59_2449
Update SSL || User : 0 | Global Round : 4 | Local Epoch : 23.0 | [0/100 (0%)]	Loss: 4.663456                         LR: 0.0001  Feat: 0.864 Epoch Time: 3.819 Model Time: 0.035 Data Time: 0.879 Model: 06-07_23:59_2449
Update SSL || User : 0 | Global Round : 4 | Local Epoch : 24.0 | [0/100 (0%)]	Loss: 4.594512                         LR: 0.0001  Feat: 0.867 Epoch Time: 4.786 Model Time: 0.035 Data Time: 0.838 Model: 06-07_23:59_2449
New Find_phi_psi for agent:  0
Updating local model for agent:  1
Update SSL || User : 1 | Global Round : 4 | Local Epoch : 20.0 | [0/100 (0%)]	Loss: 4.678121                         LR: 0.0001  Feat: 0.872 Epoch Time: 0.870 Model Time: 0.032 Data Time: 0.816 Model: 06-07_23:59_2449
Update SSL || User : 1 | Global Round : 4 | Local Epoch : 21.0 | [0/100 (0%)]	Loss: 4.747110                         LR: 0.0001  Feat: 0.870 Epoch Time: 1.950 Model Time: 0.033 Data Time: 0.963 Model: 06-07_23:59_2449
Update SSL || User : 1 | Global Round : 4 | Local Epoch : 22.0 | [0/100 (0%)]	Loss: 4.499341                         LR: 0.0001  Feat: 0.862 Epoch Time: 2.929 Model Time: 0.034 Data Time: 0.858 Model: 06-07_23:59_2449
Update SSL || User : 1 | Global Round : 4 | Local Epoch : 23.0 | [0/100 (0%)]	Loss: 4.650097                         LR: 0.0001  Feat: 0.863 Epoch Time: 3.904 Model Time: 0.040 Data Time: 0.853 Model: 06-07_23:59_2449
Update SSL || User : 1 | Global Round : 4 | Local Epoch : 24.0 | [0/100 (0%)]	Loss: 4.522548                         LR: 0.0001  Feat: 0.867 Epoch Time: 4.903 Model Time: 0.035 Data Time: 0.890 Model: 06-07_23:59_2449
New Find_phi_psi for agent:  1
Updating local model for agent:  2
Update SSL || User : 2 | Global Round : 4 | Local Epoch : 20.0 | [0/100 (0%)]	Loss: 4.576564                         LR: 0.0001  Feat: 0.871 Epoch Time: 0.934 Model Time: 0.041 Data Time: 0.879 Model: 06-07_23:59_2449
Update SSL || User : 2 | Global Round : 4 | Local Epoch : 21.0 | [0/100 (0%)]	Loss: 4.646952                         LR: 0.0001  Feat: 0.868 Epoch Time: 1.913 Model Time: 0.036 Data Time: 0.865 Model: 06-07_23:59_2449
Update SSL || User : 2 | Global Round : 4 | Local Epoch : 22.0 | [0/100 (0%)]	Loss: 4.649948                         LR: 0.0001  Feat: 0.854 Epoch Time: 2.847 Model Time: 0.033 Data Time: 0.818 Model: 06-07_23:59_2449
Update SSL || User : 2 | Global Round : 4 | Local Epoch : 23.0 | [0/100 (0%)]	Loss: 4.624650                         LR: 0.0001  Feat: 0.852 Epoch Time: 3.826 Model Time: 0.034 Data Time: 0.872 Model: 06-07_23:59_2449
Update SSL || User : 2 | Global Round : 4 | Local Epoch : 24.0 | [0/100 (0%)]	Loss: 4.518462                         LR: 0.0001  Feat: 0.863 Epoch Time: 4.820 Model Time: 0.036 Data Time: 0.876 Model: 06-07_23:59_2449
New Find_phi_psi for agent:  2
Updating local model for agent:  3
Update SSL || User : 3 | Global Round : 4 | Local Epoch : 20.0 | [0/100 (0%)]	Loss: 4.750165                         LR: 0.0001  Feat: 0.877 Epoch Time: 0.926 Model Time: 0.041 Data Time: 0.869 Model: 06-07_23:59_2449
Update SSL || User : 3 | Global Round : 4 | Local Epoch : 21.0 | [0/100 (0%)]	Loss: 4.663150                         LR: 0.0001  Feat: 0.873 Epoch Time: 1.942 Model Time: 0.039 Data Time: 0.889 Model: 06-07_23:59_2449
Update SSL || User : 3 | Global Round : 4 | Local Epoch : 22.0 | [0/100 (0%)]	Loss: 4.711112                         LR: 0.0001  Feat: 0.874 Epoch Time: 2.955 Model Time: 0.039 Data Time: 0.902 Model: 06-07_23:59_2449
Update SSL || User : 3 | Global Round : 4 | Local Epoch : 23.0 | [0/100 (0%)]	Loss: 4.649480                         LR: 0.0001  Feat: 0.873 Epoch Time: 3.976 Model Time: 0.042 Data Time: 0.898 Model: 06-07_23:59_2449
Update SSL || User : 3 | Global Round : 4 | Local Epoch : 24.0 | [0/100 (0%)]	Loss: 4.646036                         LR: 0.0001  Feat: 0.873 Epoch Time: 4.965 Model Time: 0.037 Data Time: 0.882 Model: 06-07_23:59_2449
New Find_phi_psi for agent:  3
Updating local model for agent:  4
Update SSL || User : 4 | Global Round : 4 | Local Epoch : 20.0 | [0/100 (0%)]	Loss: 4.712869                         LR: 0.0001  Feat: 0.870 Epoch Time: 0.939 Model Time: 0.038 Data Time: 0.884 Model: 06-07_23:59_2449
Update SSL || User : 4 | Global Round : 4 | Local Epoch : 21.0 | [0/100 (0%)]	Loss: 4.571304                         LR: 0.0001  Feat: 0.865 Epoch Time: 1.900 Model Time: 0.036 Data Time: 0.848 Model: 06-07_23:59_2449
Update SSL || User : 4 | Global Round : 4 | Local Epoch : 22.0 | [0/100 (0%)]	Loss: 4.557896                         LR: 0.0001  Feat: 0.851 Epoch Time: 2.838 Model Time: 0.031 Data Time: 0.830 Model: 06-07_23:59_2449
Update SSL || User : 4 | Global Round : 4 | Local Epoch : 23.0 | [0/100 (0%)]	Loss: 4.700407                         LR: 0.0001  Feat: 0.831 Epoch Time: 3.850 Model Time: 0.038 Data Time: 0.902 Model: 06-07_23:59_2449
Update SSL || User : 4 | Global Round : 4 | Local Epoch : 24.0 | [0/100 (0%)]	Loss: 4.579550                         LR: 0.0001  Feat: 0.845 Epoch Time: 4.856 Model Time: 0.037 Data Time: 0.884 Model: 06-07_23:59_2449
New Find_phi_psi for agent:  4
Exact Diffusion
exact_diffusion_averaging
combine_to_state_dict between 5 agents

 | Global Training Round : 6 | Model : 06-07_23:59_2449

Updating local model for agent:  0
Update SSL || User : 0 | Global Round : 5 | Local Epoch : 25.0 | [0/100 (0%)]	Loss: 4.696762                         LR: 0.0000  Feat: 0.859 Epoch Time: 0.929 Model Time: 0.042 Data Time: 0.872 Model: 06-07_23:59_2449
Update SSL || User : 0 | Global Round : 5 | Local Epoch : 26.0 | [0/100 (0%)]	Loss: 4.655547                         LR: 0.0000  Feat: 0.864 Epoch Time: 1.948 Model Time: 0.033 Data Time: 0.893 Model: 06-07_23:59_2449
Update SSL || User : 0 | Global Round : 5 | Local Epoch : 27.0 | [0/100 (0%)]	Loss: 4.484280                         LR: 0.0000  Feat: 0.866 Epoch Time: 2.948 Model Time: 0.032 Data Time: 0.892 Model: 06-07_23:59_2449
Update SSL || User : 0 | Global Round : 5 | Local Epoch : 28.0 | [0/100 (0%)]	Loss: 4.612012                         LR: 0.0000  Feat: 0.866 Epoch Time: 3.960 Model Time: 0.037 Data Time: 0.891 Model: 06-07_23:59_2449
Update SSL || User : 0 | Global Round : 5 | Local Epoch : 29.0 | [0/100 (0%)]	Loss: 4.696375                         LR: 0.0000  Feat: 0.865 Epoch Time: 4.948 Model Time: 0.037 Data Time: 0.876 Model: 06-07_23:59_2449
New Find_phi_psi for agent:  0
Updating local model for agent:  1
Update SSL || User : 1 | Global Round : 5 | Local Epoch : 25.0 | [0/100 (0%)]	Loss: 4.541437                         LR: 0.0000  Feat: 0.861 Epoch Time: 0.887 Model Time: 0.037 Data Time: 0.832 Model: 06-07_23:59_2449
Update SSL || User : 1 | Global Round : 5 | Local Epoch : 26.0 | [0/100 (0%)]	Loss: 4.611158                         LR: 0.0000  Feat: 0.865 Epoch Time: 1.842 Model Time: 0.043 Data Time: 0.834 Model: 06-07_23:59_2449
Update SSL || User : 1 | Global Round : 5 | Local Epoch : 27.0 | [0/100 (0%)]	Loss: 4.569434                         LR: 0.0000  Feat: 0.860 Epoch Time: 2.818 Model Time: 0.037 Data Time: 0.852 Model: 06-07_23:59_2449
Update SSL || User : 1 | Global Round : 5 | Local Epoch : 28.0 | [0/100 (0%)]	Loss: 4.600418                         LR: 0.0000  Feat: 0.865 Epoch Time: 3.792 Model Time: 0.038 Data Time: 0.860 Model: 06-07_23:59_2449
Update SSL || User : 1 | Global Round : 5 | Local Epoch : 29.0 | [0/100 (0%)]	Loss: 4.587999                         LR: 0.0000  Feat: 0.865 Epoch Time: 4.763 Model Time: 0.035 Data Time: 0.853 Model: 06-07_23:59_2449
New Find_phi_psi for agent:  1
Updating local model for agent:  2
Update SSL || User : 2 | Global Round : 5 | Local Epoch : 25.0 | [0/100 (0%)]	Loss: 4.596458                         LR: 0.0000  Feat: 0.857 Epoch Time: 0.896 Model Time: 0.039 Data Time: 0.841 Model: 06-07_23:59_2449
Update SSL || User : 2 | Global Round : 5 | Local Epoch : 26.0 | [0/100 (0%)]	Loss: 4.628334                         LR: 0.0000  Feat: 0.852 Epoch Time: 1.883 Model Time: 0.040 Data Time: 0.863 Model: 06-07_23:59_2449
Update SSL || User : 2 | Global Round : 5 | Local Epoch : 27.0 | [0/100 (0%)]	Loss: 4.535804                         LR: 0.0000  Feat: 0.867 Epoch Time: 2.852 Model Time: 0.033 Data Time: 0.843 Model: 06-07_23:59_2449
Update SSL || User : 2 | Global Round : 5 | Local Epoch : 28.0 | [0/100 (0%)]	Loss: 4.436586                         LR: 0.0000  Feat: 0.863 Epoch Time: 3.865 Model Time: 0.036 Data Time: 0.880 Model: 06-07_23:59_2449
Update SSL || User : 2 | Global Round : 5 | Local Epoch : 29.0 | [0/100 (0%)]	Loss: 4.451534                         LR: 0.0000  Feat: 0.862 Epoch Time: 4.875 Model Time: 0.037 Data Time: 0.893 Model: 06-07_23:59_2449
New Find_phi_psi for agent:  2
Updating local model for agent:  3
Update SSL || User : 3 | Global Round : 5 | Local Epoch : 25.0 | [0/100 (0%)]	Loss: 4.569289                         LR: 0.0000  Feat: 0.865 Epoch Time: 0.927 Model Time: 0.043 Data Time: 0.870 Model: 06-07_23:59_2449
Update SSL || User : 3 | Global Round : 5 | Local Epoch : 26.0 | [0/100 (0%)]	Loss: 4.438658                         LR: 0.0000  Feat: 0.862 Epoch Time: 1.925 Model Time: 0.034 Data Time: 0.871 Model: 06-07_23:59_2449
Update SSL || User : 3 | Global Round : 5 | Local Epoch : 27.0 | [0/100 (0%)]	Loss: 4.582514                         LR: 0.0000  Feat: 0.872 Epoch Time: 2.925 Model Time: 0.040 Data Time: 0.874 Model: 06-07_23:59_2449
Update SSL || User : 3 | Global Round : 5 | Local Epoch : 28.0 | [0/100 (0%)]	Loss: 4.686025                         LR: 0.0000  Feat: 0.866 Epoch Time: 3.888 Model Time: 0.032 Data Time: 0.852 Model: 06-07_23:59_2449
Update SSL || User : 3 | Global Round : 5 | Local Epoch : 29.0 | [0/100 (0%)]	Loss: 4.580993                         LR: 0.0000  Feat: 0.868 Epoch Time: 4.837 Model Time: 0.036 Data Time: 0.825 Model: 06-07_23:59_2449
New Find_phi_psi for agent:  3
Updating local model for agent:  4
Update SSL || User : 4 | Global Round : 5 | Local Epoch : 25.0 | [0/100 (0%)]	Loss: 4.699695                         LR: 0.0000  Feat: 0.855 Epoch Time: 0.918 Model Time: 0.036 Data Time: 0.863 Model: 06-07_23:59_2449
Update SSL || User : 4 | Global Round : 5 | Local Epoch : 26.0 | [0/100 (0%)]	Loss: 4.647389                         LR: 0.0000  Feat: 0.867 Epoch Time: 1.929 Model Time: 0.038 Data Time: 0.884 Model: 06-07_23:59_2449
Update SSL || User : 4 | Global Round : 5 | Local Epoch : 27.0 | [0/100 (0%)]	Loss: 4.531489                         LR: 0.0000  Feat: 0.853 Epoch Time: 2.932 Model Time: 0.035 Data Time: 0.883 Model: 06-07_23:59_2449
Update SSL || User : 4 | Global Round : 5 | Local Epoch : 28.0 | [0/100 (0%)]	Loss: 4.568205                         LR: 0.0000  Feat: 0.849 Epoch Time: 3.948 Model Time: 0.044 Data Time: 0.890 Model: 06-07_23:59_2449
Update SSL || User : 4 | Global Round : 5 | Local Epoch : 29.0 | [0/100 (0%)]	Loss: 4.571608                         LR: 0.0000  Feat: 0.850 Epoch Time: 4.897 Model Time: 0.037 Data Time: 0.822 Model: 06-07_23:59_2449
New Find_phi_psi for agent:  4
Exact Diffusion
exact_diffusion_averaging
combine_to_state_dict between 5 agents
evaluating representations:  save/06-07_23:59_2449dirich_False_dec-True_ED-True_pe1.0_a5_e30_le5.0
Training a classifier on each of the local models and averaging the accuracy result
Start tarining Classifier for user 4
Training classifier
sampling for dataset: mnist
Files already downloaded and verified
train dataset sample num: (50000, 32, 32, 3)
Files already downloaded and verified
Files already downloaded and verified
get dataset time: 2.188
Use i.i.d. sampling
Use i.i.d. sampling
sample dataset time: 0.067
user data samples: [10000, 10000, 10000, 10000, 10000]
begin training classifier...
Backbone model function:  <function resnet18 at 0x7f3ff26f16c0>
Downstream Train Epoch: 1 [0/50000 (0%)]	Loss: 2.389745
Downstream Train Epoch: 1 [12800/50000 (26%)]	Loss: 2.040443
Downstream Train Epoch: 1 [25600/50000 (51%)]	Loss: 2.053842
Downstream Train Epoch: 1 [38400/50000 (77%)]	Loss: 1.999632

 Downstream Train loss: 2.0310875317271875 Acc: 0.3201
Downstream Train Epoch: 2 [0/50000 (0%)]	Loss: 1.971450
Downstream Train Epoch: 2 [12800/50000 (26%)]	Loss: 2.005318
Downstream Train Epoch: 2 [25600/50000 (51%)]	Loss: 1.931986
Downstream Train Epoch: 2 [38400/50000 (77%)]	Loss: 1.929115

 Downstream Train loss: 1.9842239520987686 Acc: 0.331
Downstream Train Epoch: 3 [0/50000 (0%)]	Loss: 2.038387
Downstream Train Epoch: 3 [12800/50000 (26%)]	Loss: 1.991636
Downstream Train Epoch: 3 [25600/50000 (51%)]	Loss: 1.985885
Downstream Train Epoch: 3 [38400/50000 (77%)]	Loss: 1.876487

 Downstream Train loss: 1.965576532543922 Acc: 0.3641
Downstream Train Epoch: 4 [0/50000 (0%)]	Loss: 1.989699
Downstream Train Epoch: 4 [12800/50000 (26%)]	Loss: 1.985331
Downstream Train Epoch: 4 [25600/50000 (51%)]	Loss: 1.939022
Downstream Train Epoch: 4 [38400/50000 (77%)]	Loss: 1.977962

 Downstream Train loss: 1.9565839518089683 Acc: 0.3652
Downstream Train Epoch: 5 [0/50000 (0%)]	Loss: 1.945356
Downstream Train Epoch: 5 [12800/50000 (26%)]	Loss: 1.862610
Downstream Train Epoch: 5 [25600/50000 (51%)]	Loss: 1.946059
Downstream Train Epoch: 5 [38400/50000 (77%)]	Loss: 1.961978

 Downstream Train loss: 1.9487530181602555 Acc: 0.3652
Downstream Train Epoch: 6 [0/50000 (0%)]	Loss: 2.006157
Downstream Train Epoch: 6 [12800/50000 (26%)]	Loss: 1.889817
Downstream Train Epoch: 6 [25600/50000 (51%)]	Loss: 1.986085
Downstream Train Epoch: 6 [38400/50000 (77%)]	Loss: 1.932320

 Downstream Train loss: 1.9411745983727124 Acc: 0.3726
Downstream Train Epoch: 7 [0/50000 (0%)]	Loss: 1.955716
Downstream Train Epoch: 7 [12800/50000 (26%)]	Loss: 1.913981
Downstream Train Epoch: 7 [25600/50000 (51%)]	Loss: 1.937609
Downstream Train Epoch: 7 [38400/50000 (77%)]	Loss: 1.896792

 Downstream Train loss: 1.935220225124943 Acc: 0.3795
Downstream Train Epoch: 8 [0/50000 (0%)]	Loss: 1.930014
Downstream Train Epoch: 8 [12800/50000 (26%)]	Loss: 1.880219
Downstream Train Epoch: 8 [25600/50000 (51%)]	Loss: 1.897934
Downstream Train Epoch: 8 [38400/50000 (77%)]	Loss: 1.897128

 Downstream Train loss: 1.9313324428334528 Acc: 0.3795
Downstream Train Epoch: 9 [0/50000 (0%)]	Loss: 1.966591
Downstream Train Epoch: 9 [12800/50000 (26%)]	Loss: 1.845619
Downstream Train Epoch: 9 [25600/50000 (51%)]	Loss: 1.924802
Downstream Train Epoch: 9 [38400/50000 (77%)]	Loss: 1.765261

 Downstream Train loss: 1.9292965148176466 Acc: 0.3795
Downstream Train Epoch: 10 [0/50000 (0%)]	Loss: 1.908858
Downstream Train Epoch: 10 [12800/50000 (26%)]	Loss: 1.931362
Downstream Train Epoch: 10 [25600/50000 (51%)]	Loss: 1.959222
Downstream Train Epoch: 10 [38400/50000 (77%)]	Loss: 1.866262

 Downstream Train loss: 1.9240262660445 Acc: 0.3909
Downstream Train Epoch: 11 [0/50000 (0%)]	Loss: 1.874813
Downstream Train Epoch: 11 [12800/50000 (26%)]	Loss: 1.948480
Downstream Train Epoch: 11 [25600/50000 (51%)]	Loss: 1.962679
Downstream Train Epoch: 11 [38400/50000 (77%)]	Loss: 1.971623

 Downstream Train loss: 1.921072666134153 Acc: 0.3909
Downstream Train Epoch: 12 [0/50000 (0%)]	Loss: 1.880314
Downstream Train Epoch: 12 [12800/50000 (26%)]	Loss: 1.953259
Downstream Train Epoch: 12 [25600/50000 (51%)]	Loss: 1.861835
Downstream Train Epoch: 12 [38400/50000 (77%)]	Loss: 1.857736

 Downstream Train loss: 1.9208846621367397 Acc: 0.3909
Downstream Train Epoch: 13 [0/50000 (0%)]	Loss: 1.947596
Downstream Train Epoch: 13 [12800/50000 (26%)]	Loss: 2.018082
Downstream Train Epoch: 13 [25600/50000 (51%)]	Loss: 1.914587
Downstream Train Epoch: 13 [38400/50000 (77%)]	Loss: 1.855216

 Downstream Train loss: 1.9083724119225327 Acc: 0.3909
Downstream Train Epoch: 14 [0/50000 (0%)]	Loss: 1.915424
Downstream Train Epoch: 14 [12800/50000 (26%)]	Loss: 1.910558
Downstream Train Epoch: 14 [25600/50000 (51%)]	Loss: 2.008322
Downstream Train Epoch: 14 [38400/50000 (77%)]	Loss: 1.835962

 Downstream Train loss: 1.9070441966154137 Acc: 0.3909
Downstream Train Epoch: 15 [0/50000 (0%)]	Loss: 1.901250
Downstream Train Epoch: 15 [12800/50000 (26%)]	Loss: 1.992172
Downstream Train Epoch: 15 [25600/50000 (51%)]	Loss: 1.904804
Downstream Train Epoch: 15 [38400/50000 (77%)]	Loss: 1.885529

 Downstream Train loss: 1.908782598315453 Acc: 0.3909
Downstream Train Epoch: 16 [0/50000 (0%)]	Loss: 1.906390
Downstream Train Epoch: 16 [12800/50000 (26%)]	Loss: 1.972753
Downstream Train Epoch: 16 [25600/50000 (51%)]	Loss: 1.935507
Downstream Train Epoch: 16 [38400/50000 (77%)]	Loss: 1.934182

 Downstream Train loss: 1.9068550838499654 Acc: 0.3928
Downstream Train Epoch: 17 [0/50000 (0%)]	Loss: 1.894655
Downstream Train Epoch: 17 [12800/50000 (26%)]	Loss: 1.913161
Downstream Train Epoch: 17 [25600/50000 (51%)]	Loss: 1.873322
Downstream Train Epoch: 17 [38400/50000 (77%)]	Loss: 1.858546

 Downstream Train loss: 1.902984611842097 Acc: 0.3928
Downstream Train Epoch: 18 [0/50000 (0%)]	Loss: 1.859218
Downstream Train Epoch: 18 [12800/50000 (26%)]	Loss: 1.907469
Downstream Train Epoch: 18 [25600/50000 (51%)]	Loss: 1.930363
Downstream Train Epoch: 18 [38400/50000 (77%)]	Loss: 1.843000

 Downstream Train loss: 1.9014792399747031 Acc: 0.3928
Downstream Train Epoch: 19 [0/50000 (0%)]	Loss: 1.901989
Downstream Train Epoch: 19 [12800/50000 (26%)]	Loss: 1.885621
Downstream Train Epoch: 19 [25600/50000 (51%)]	Loss: 1.893946
Downstream Train Epoch: 19 [38400/50000 (77%)]	Loss: 1.969718

 Downstream Train loss: 1.9033960797348801 Acc: 0.3949
Downstream Train Epoch: 20 [0/50000 (0%)]	Loss: 1.941782
Downstream Train Epoch: 20 [12800/50000 (26%)]	Loss: 1.898314
Downstream Train Epoch: 20 [25600/50000 (51%)]	Loss: 1.809335
Downstream Train Epoch: 20 [38400/50000 (77%)]	Loss: 1.810881

 Downstream Train loss: 1.8986300248272565 Acc: 0.3975
Downstream Train Epoch: 21 [0/50000 (0%)]	Loss: 1.920170
Downstream Train Epoch: 21 [12800/50000 (26%)]	Loss: 1.901902
Downstream Train Epoch: 21 [25600/50000 (51%)]	Loss: 1.958398
Downstream Train Epoch: 21 [38400/50000 (77%)]	Loss: 1.849537

 Downstream Train loss: 1.8941188862129135 Acc: 0.3975
Downstream Train Epoch: 22 [0/50000 (0%)]	Loss: 1.965147
Downstream Train Epoch: 22 [12800/50000 (26%)]	Loss: 1.928058
Downstream Train Epoch: 22 [25600/50000 (51%)]	Loss: 1.865420
Downstream Train Epoch: 22 [38400/50000 (77%)]	Loss: 1.843136

 Downstream Train loss: 1.8955108486876195 Acc: 0.3975
Downstream Train Epoch: 23 [0/50000 (0%)]	Loss: 1.885790
Downstream Train Epoch: 23 [12800/50000 (26%)]	Loss: 1.848055
Downstream Train Epoch: 23 [25600/50000 (51%)]	Loss: 1.852680
Downstream Train Epoch: 23 [38400/50000 (77%)]	Loss: 1.883044

 Downstream Train loss: 1.895928908975757 Acc: 0.3975
Downstream Train Epoch: 24 [0/50000 (0%)]	Loss: 1.852650
Downstream Train Epoch: 24 [12800/50000 (26%)]	Loss: 1.939039
Downstream Train Epoch: 24 [25600/50000 (51%)]	Loss: 1.881566
Downstream Train Epoch: 24 [38400/50000 (77%)]	Loss: 1.901762

 Downstream Train loss: 1.895142846569723 Acc: 0.3975
Downstream Train Epoch: 25 [0/50000 (0%)]	Loss: 1.887293
Downstream Train Epoch: 25 [12800/50000 (26%)]	Loss: 1.950031
Downstream Train Epoch: 25 [25600/50000 (51%)]	Loss: 1.889442
Downstream Train Epoch: 25 [38400/50000 (77%)]	Loss: 1.906126

 Downstream Train loss: 1.8869835247798843 Acc: 0.406
Downstream Train Epoch: 26 [0/50000 (0%)]	Loss: 1.880522
Downstream Train Epoch: 26 [12800/50000 (26%)]	Loss: 1.918146
Downstream Train Epoch: 26 [25600/50000 (51%)]	Loss: 1.903172
Downstream Train Epoch: 26 [38400/50000 (77%)]	Loss: 1.909129

 Downstream Train loss: 1.8935578854716555 Acc: 0.406
Downstream Train Epoch: 27 [0/50000 (0%)]	Loss: 1.916759
Downstream Train Epoch: 27 [12800/50000 (26%)]	Loss: 1.866439
Downstream Train Epoch: 27 [25600/50000 (51%)]	Loss: 1.841408
Downstream Train Epoch: 27 [38400/50000 (77%)]	Loss: 1.972783

 Downstream Train loss: 1.8921840099655851 Acc: 0.406
Downstream Train Epoch: 28 [0/50000 (0%)]	Loss: 1.822875
Downstream Train Epoch: 28 [12800/50000 (26%)]	Loss: 1.940187
Downstream Train Epoch: 28 [25600/50000 (51%)]	Loss: 1.903116
Downstream Train Epoch: 28 [38400/50000 (77%)]	Loss: 1.931516

 Downstream Train loss: 1.8870312857384584 Acc: 0.406
Downstream Train Epoch: 29 [0/50000 (0%)]	Loss: 1.845195
Downstream Train Epoch: 29 [12800/50000 (26%)]	Loss: 1.831986
Downstream Train Epoch: 29 [25600/50000 (51%)]	Loss: 1.896856
Downstream Train Epoch: 29 [38400/50000 (77%)]	Loss: 1.805522

 Downstream Train loss: 1.8881303905224314 Acc: 0.406
Downstream Train Epoch: 30 [0/50000 (0%)]	Loss: 1.867896
Downstream Train Epoch: 30 [12800/50000 (26%)]	Loss: 1.901822
Downstream Train Epoch: 30 [25600/50000 (51%)]	Loss: 1.849036
Downstream Train Epoch: 30 [38400/50000 (77%)]	Loss: 1.903843

 Downstream Train loss: 1.8853241922904034 Acc: 0.406
Downstream Train Epoch: 31 [0/50000 (0%)]	Loss: 1.958477
Downstream Train Epoch: 31 [12800/50000 (26%)]	Loss: 1.822812
Downstream Train Epoch: 31 [25600/50000 (51%)]	Loss: 1.927656
Downstream Train Epoch: 31 [38400/50000 (77%)]	Loss: 1.851400

 Downstream Train loss: 1.8863253271093174 Acc: 0.406
Downstream Train Epoch: 32 [0/50000 (0%)]	Loss: 1.902350
Downstream Train Epoch: 32 [12800/50000 (26%)]	Loss: 1.805362
Downstream Train Epoch: 32 [25600/50000 (51%)]	Loss: 1.883010
Downstream Train Epoch: 32 [38400/50000 (77%)]	Loss: 1.823448

 Downstream Train loss: 1.878551100589791 Acc: 0.406
Downstream Train Epoch: 33 [0/50000 (0%)]	Loss: 1.851444
Downstream Train Epoch: 33 [12800/50000 (26%)]	Loss: 1.894421
Downstream Train Epoch: 33 [25600/50000 (51%)]	Loss: 1.868788
Downstream Train Epoch: 33 [38400/50000 (77%)]	Loss: 1.912037

 Downstream Train loss: 1.8773497276160183 Acc: 0.406
Downstream Train Epoch: 34 [0/50000 (0%)]	Loss: 1.872536
Downstream Train Epoch: 34 [12800/50000 (26%)]	Loss: 1.984045
Downstream Train Epoch: 34 [25600/50000 (51%)]	Loss: 1.848829
Downstream Train Epoch: 34 [38400/50000 (77%)]	Loss: 1.861873

 Downstream Train loss: 1.8799766502818283 Acc: 0.406
Downstream Train Epoch: 35 [0/50000 (0%)]	Loss: 1.833276
Downstream Train Epoch: 35 [12800/50000 (26%)]	Loss: 1.922794
Downstream Train Epoch: 35 [25600/50000 (51%)]	Loss: 1.916341
Downstream Train Epoch: 35 [38400/50000 (77%)]	Loss: 1.963169

 Downstream Train loss: 1.8849389127322607 Acc: 0.406
Downstream Train Epoch: 36 [0/50000 (0%)]	Loss: 1.820137
Downstream Train Epoch: 36 [12800/50000 (26%)]	Loss: 1.854794
Downstream Train Epoch: 36 [25600/50000 (51%)]	Loss: 1.868016
Downstream Train Epoch: 36 [38400/50000 (77%)]	Loss: 1.824557

 Downstream Train loss: 1.8851903622247734 Acc: 0.406
Downstream Train Epoch: 37 [0/50000 (0%)]	Loss: 1.951088
Downstream Train Epoch: 37 [12800/50000 (26%)]	Loss: 1.878536
Downstream Train Epoch: 37 [25600/50000 (51%)]	Loss: 1.940619
Downstream Train Epoch: 37 [38400/50000 (77%)]	Loss: 1.886242

 Downstream Train loss: 1.8812320141159757 Acc: 0.406
Downstream Train Epoch: 38 [0/50000 (0%)]	Loss: 1.857459
Downstream Train Epoch: 38 [12800/50000 (26%)]	Loss: 1.866992
Downstream Train Epoch: 38 [25600/50000 (51%)]	Loss: 1.819702
Downstream Train Epoch: 38 [38400/50000 (77%)]	Loss: 1.851788

 Downstream Train loss: 1.878765184660347 Acc: 0.406
Downstream Train Epoch: 39 [0/50000 (0%)]	Loss: 1.810104
Downstream Train Epoch: 39 [12800/50000 (26%)]	Loss: 1.834401
Downstream Train Epoch: 39 [25600/50000 (51%)]	Loss: 1.865966
Downstream Train Epoch: 39 [38400/50000 (77%)]	Loss: 1.875565

 Downstream Train loss: 1.8831644733341373 Acc: 0.406
Downstream Train Epoch: 40 [0/50000 (0%)]	Loss: 1.909111
Downstream Train Epoch: 40 [12800/50000 (26%)]	Loss: 1.884105
Downstream Train Epoch: 40 [25600/50000 (51%)]	Loss: 1.929336
Downstream Train Epoch: 40 [38400/50000 (77%)]	Loss: 1.842098

 Downstream Train loss: 1.8746031309877123 Acc: 0.4136
Classifier Accuracy for user 4 is 0.4136
Training a classifier on the federated global model
 
 Results after 30 global rounds of training:
|----Average Classifier Test Accuracy for 5 agents is: 41.36%

 Total Run Time: 618.7940
Namespace(split_dataset=None, average_with_A=False, phi_equal_w=False, exact_diffusion=True, decentralized=True, edge_prob=1.0, epochs=30, num_users=5, frac=1.0, local_ep=5.0, local_bs=256, lr=0.001, momentum=0.9, num_workers=16, model='resnet', batch_size=256, weight_decay=0.0005, dataset='mnist', backbone='resnet18', num_classes=10, gpu='1', optimizer='adam', save_name_suffix='', iid=1, verbose=0, seed=1, feature_dim=128, temperature=0.5, k=200, ssl_method='simclr', x_noniid=False, dirichlet=False, test_intermediate=False, dir_beta=0.5, imagenet_based_cluster=False, y_partition=False, log_file_name='comm_scripts/best_linear_statistics_skew_ssl_comm.csv', num_clusters=1, imagenet100=False, y_partition_skew=False, y_partition_ratio=1, x_shift_dirichlet=False, reg_scale=1, load_pretrained_path='', full_size=False, local_rank=0, distributed_training=False, log_directory='exact_new_edge/06-07_23:59_drich-false_dec-true_ED-true_ep1_e30_le5_a5', emd=0, dist_url='env://', average_without_bn=False, model_continue_training=0, finetuning_epoch=40, script_name='', x_shift_skew=False, load_dataset_to_memory=False, model_time='06-07_23:59_2449', start_time=datetime.datetime(2024, 6, 7, 23, 59, 48, 884916))
dec_True_ED_True_a_5_resnet_256_30__dec_ssl_simclr
